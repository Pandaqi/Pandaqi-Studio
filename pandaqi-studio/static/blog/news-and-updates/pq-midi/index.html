<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>PQ_MIDI: A music player for interactive tutorials | Pandaqi Blog</title><link rel=icon type=image/png href=https://pandaqi.com/blog//favicon.png><link rel=stylesheet type=text/css href=/blog/css/critical.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin></head><body><header id=site-header><nav class=menu><ul><li><a href=https://pandaqi.com/blog/ class="masked-link big-mask mask-4" style=--rotation:2deg>Home</a></li><li><a href=/blog/boardgames/ class="masked-link big-mask mask-4" style=--rotation:-0.5deg>Boardgames</a></li><li><a href=/blog/news-and-updates/ class="masked-link big-mask mask-1" style=--rotation:0deg>News & Updates</a></li><li><a href=/blog/reviews-and-thoughts/ class="masked-link big-mask mask-1" style=--rotation:0.5deg>Reviews & Thoughts</a></li><li><a href=/blog/tutorials/ class="masked-link big-mask mask-2" style=--rotation:-0.5deg>Tutorials</a></li><li><a href=/blog/videogames/ class="masked-link big-mask mask-6" style=--rotation:0.5deg>Videogames</a></li></ul></nav></header><main class="padding center-block"><article class=single-article><div class=thumbnail-media><img src=pq_midi_what_it_looks_like.webp></div><h1>PQ_MIDI: A music player for interactive tutorials</h1><aside class=metadata><nav class=breadcrumbs><span class=metadata-label><span class=emoji>ü•ê</span> Breadcrumbs ||</span>
<a href=https://pandaqi.com/blog/>Home</a>
/
<a href=https://pandaqi.com/blog/news-and-updates/>News and updates</a>
/
<a href=https://pandaqi.com/blog/news-and-updates/pq-midi/>Pq midi</a></nav><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/pandaqi.com\/blog\/","name":"home"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/pandaqi.com\/blog\/news-and-updates\/","name":"news-and-updates"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/pandaqi.com\/blog\/news-and-updates\/pq-midi\/","name":"pq-midi"}}]}</script><div><span class=metadata-label><span class=emoji>&#8987;</span> Published ||</span>
<time datetime=2023-01-19T00:00:00>Thursday, Jan 19, 2023</time></div><div><span class=metadata-label><span class=emoji>üìñ</span> Table of Contents ||</span>
<a href=# id=toc-toggle>Show</a></div></aside><aside id=table-of-contents class=masked-link-block><header><h2>Table of Contents</h2></header><nav id=TableOfContents><ul><li><a href=#why>Why?</a></li><li><a href=#usage>Usage</a></li><li><a href=#how>How?</a></li><li><a href=#future>Future</a></li><li><a href=#shortcode>Shortcode</a><ul><li><a href=#parameters>Parameters</a></li><li><a href=#example>Example</a></li></ul></li><li><a href=#syntax>Syntax</a><ul><li><a href=#tracks>Tracks</a></li><li><a href=#notes>Notes</a></li><li><a href=#pitch>Pitch</a></li><li><a href=#time>Time</a></li><li><a href=#volume>Volume</a></li><li><a href=#example-1>Example</a></li></ul></li><li><a href=#configuration>Configuration</a></li></ul></nav></aside><div><p>I made a thing again! Something I couldn&rsquo;t find anywhere else on the internet, but which proved to be immensely useful. It&rsquo;s called &ldquo;PQ_MIDI&rdquo; ( = Pandaqi Midi).</p><p>It&rsquo;s an <strong>audio visualizer and player</strong> using vanilla JavaScript, specifically made for usage in a Hugo website.</p><p>It&rsquo;s not a <em>true</em> MIDI player. The input is a piece of text with a simple syntax. I needed a simple tool that was both songwriting, audio and visualization (that wasn&rsquo;t sheet music) in one. I called it PQ_MIDI because it&rsquo;s the closest thing to it.</p><p>If you have some coding knowledge, you can modify it to work anywhere. (A Hugo &ldquo;shortcode&rdquo; is just a fixed piece of HTML that&rsquo;s printed to a page, which you can hand arguments. Any other website system probably has a similar functionality.)</p><p>Like all the custom tools I build, it was written hastily and to do <em>one</em> thing very well. Use it at your own risk.</p><p>What does it do?</p><ul><li>Use the <code>midi</code> shortcode on any Hugo page</li><li>Between the tags, add your melody using some simple syntax</li><li>The library converts this into playable audio</li><li>And a visual that shows the notes as they&rsquo;re being played.</li></ul><p>You can find it on GitHub: <a href=https://github.com/pandaqi/pq-midi>PQ MIDI on Github</a></p><p>This is what it looks like.</p><p><img src=pq_midi_what_it_looks_like.webp alt="What PQ MIDI looks like, visually"></p><h2 id=why>Why?</h2><p>I needed it for my <a href=https://pandaqi.com/tutorials>Pandaqi Tutorials</a> website. There are some courses about audio and songwriting, which begged for audiovisual examples everywhere.</p><p>You can see it in action throughout this course: <a href=https://pandaqi.com/tutorials/audio/songwriting>Songwriting</a></p><h2 id=usage>Usage</h2><p>Download the JavaScript file and the folder with sound files.</p><ul><li>Place the code somewhere in your <code>assets</code> folder. Then include it on all your pages.</li><li>Place the sound in your <code>static</code> folder (or wherever you can easily reference/access it).</li></ul><p>You&rsquo;re done. It automatically detects the midi blocks and does its magic.</p><h2 id=how>How?</h2><p>The Hugo shortcode prints a piece of HTML to the page</p><ul><li>A hidden element that holds the syntax for your melody</li><li>A Canvas element (which will draw the melody)</li><li>A button (for play/stop) and some metadata (like tempo)</li></ul><p>The JavaScript finds all these elements and converts them into usable objects. It parses the melody. The Canvas displays it and the button will play it. When played, it loads audio files from a folder, buffers them, and then simply &mldr; plays them at the right time.</p><p>The sounds are exported from my DAW using the <em>Salamander Piano</em> VST, with some light editing to make it less harsh (when played this way). They are in <code>.ogg</code> format and as small as possible. All notes from <strong>C2</strong> up to and including <strong>C6</strong> are available.</p><p>All this makes the library <em>superduper fast</em>, which was one of my goals.</p><h2 id=future>Future</h2><p>Adding interactivity is on my wishlist. (Allowing my readers to create, move, edit the notes instead of just playing them.) Otherwise, it&rsquo;s completely done and I don&rsquo;t see what else I could add.</p><h2 id=shortcode>Shortcode</h2><h3 id=parameters>Parameters</h3><p>It can take these parameters. All of these are optional</p><ul><li><code>tempo</code> (number; 120): tempo of the sample in BPM</li><li><code>strict</code> (boolean; false): if true, requires some things about your syntax. (Measures need to be correct and tracks must be the same length.)</li><li><code>time</code> (number/number; 4/4): time signature of the sample</li><li><code>caption</code> (text): a caption displayed with the sample</li><li><code>transpose</code> (number; 0): transposes the whole sample</li><li><code>metronome</code> (boolean; false): if true, adds a a click track</li><li><code>pitch_input</code> (absolute or relative): how you input your pitches</li><li><code>time_input</code> (absolute, relative or tradition): how you input your note duration</li></ul><h3 id=example>Example</h3><p>Here&rsquo;s an example of using the shortcode in a Hugo file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=ln>1</span><span class=cl>  <span class=p>{{&lt;</span> <span class=nx>midi</span> <span class=nx>tempo</span><span class=p>=</span><span class=s>&#34;120&#34;</span> <span class=nx>time</span><span class=p>=</span><span class=s>&#34;4/4&#34;</span> <span class=nx>strict</span><span class=p>=</span><span class=s>&#34;true&#34;</span> <span class=nx>metronome</span><span class=p>=</span><span class=s>&#34;true&#34;</span> <span class=p>&gt;}}</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=o>...</span> <span class=nx>your</span> <span class=nx>melody</span> <span class=nx>here</span> <span class=o>...</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=p>{{&lt;</span> <span class=o>/</span><span class=nx>midi</span> <span class=p>&gt;}}</span></span></span></code></pre></div><h2 id=syntax>Syntax</h2><p>How to enter your music?</p><h3 id=tracks>Tracks</h3><p>Start each <strong>track</strong> on a new line and with <code>:</code>. A track is one continuous <em>sequence</em> of notes. (So if you want multiple notes a at the same time, use multiple tracks. You can have an infinite number of them.)</p><h3 id=notes>Notes</h3><p>A track contains <strong>notes</strong> with spaces between them. Optionally, you can add bars (<code>|</code>) to indicate where new measures should start. This is ignored, but helps keep your syntax clean and correct.</p><p>Every note has the syntax: <code>PITCH/TIME/VOLUME</code>.</p><p>The slash between <em>pitch</em> and <em>time</em> always has to exist. The one between <em>time</em> and <em>volume</em> does not. Rests are notated using the <code>R</code> pitch, whatever the other settings are.</p><h3 id=pitch>Pitch</h3><p><strong>Pitch</strong> can be given in two ways.</p><ul><li>Absolute: written as <em>note</em> + <em>octave</em>. So, C3, or E4, or F2, &mldr;</li><li>Relative: written relative to the previous note. (First note must be absolute to set a starting point.)</li></ul><p>If left out, this note <em>extends</em> the previous note. (It doesn&rsquo;t create a new note, but adds its time and volume to the previous.)</p><p><em>Relative input?</em> Use <code>^X</code> to make the note X higher than the previous. Use <code>_X</code> to make the note X lower than the previous. Never ended up using it myself, but it works.</p><h3 id=time>Time</h3><p><strong>Time</strong> can be given in three ways.</p><ul><li>Absolute: written as a <em>number</em> of beats</li><li>Relative: written relative to the previous note. (First note must be absolute to set a starting point.)</li><li>Traditional: written like sheet music. A 2 is a half note, a 4 is a quarter note, an 8 is an eight note. Add a dot to the end for dotted notes.</li></ul><p>If left out, the note defaults to a single beat.</p><p>The default is absolute. This is unconventional&mdash;you might like &ldquo;traditional&rdquo; better in many cases.</p><h3 id=volume>Volume</h3><p><strong>Volume</strong> goes from 0 to 100. Can be omitted entirely (including the slash), which defaults to 100. If slash is added, but no number, it uses the same volume as the previous note.</p><h3 id=example-1>Example</h3><p>Here&rsquo;s an example of syntax and the result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Javascript data-lang=Javascript><span class=line><span class=ln>1</span><span class=cl><span class=o>:</span><span class=nx>C4</span><span class=o>/</span><span class=mi>1</span> <span class=nx>D4</span><span class=o>/</span><span class=mi>2</span> <span class=nx>A3</span><span class=o>/</span><span class=mi>1</span> <span class=o>|</span> <span class=nx>A3</span><span class=o>/</span><span class=mi>1</span> <span class=nx>A3</span><span class=o>/</span><span class=mi>1</span> <span class=nx>C4</span><span class=o>/</span><span class=mi>2</span> <span class=o>|</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=o>:</span><span class=nx>F2</span><span class=o>/</span><span class=mi>4</span> <span class=o>|</span> <span class=nx>C3</span><span class=o>/</span><span class=mi>4</span> <span class=o>|</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=o>:</span><span class=nx>A3</span><span class=o>/</span><span class=mi>2</span> <span class=nx>R</span><span class=o>/</span><span class=mi>2</span> <span class=o>|</span> <span class=nx>G3</span><span class=o>/</span><span class=mi>4</span> <span class=o>|</span></span></span></code></pre></div><p><img src=pq_midi_inaction.webp alt="What the syntax given above will produce"></p><h2 id=configuration>Configuration</h2><p>You can change how it looks through a config. Before loading the library, define the global variable <code>PQ_MIDI</code> and assign the variable <code>config</code>.</p><p>These properties can be set:</p><ul><li><code>font</code> (object):<ul><li><code>light</code> (string; #BBB): color of the lighter text</li><li><code>dark</code> (string; #999): color of the darker text</li><li><code>size</code> (number; 30): size of text</li><li><code>family</code> (string; Dosis): font used</li></ul></li><li><code>pitch</code> (object):<ul><li><code>barLight</code> (string; white): color of the lighter horizontal bars</li><li><code>barDark</code> (string; #DDD): color of the darker horizontal bars</li><li><code>emptyPitchesAround</code> (number; 2): space above and below sample where nothing is drawn</li><li><code>textMargin</code> (number; 20): margin to offset pitch text</li><li><code>shadowSize</code> (number; 10): shadow blur to make notes pop out</li><li><code>shadowColor</code> (string; #666): color of that shadow</li><li><code>verticalScale</code> (number; 1): scales the height of the canvas (and thus pitches) by this factor</li></ul></li><li><code>time</code> (object):<ul><li><code>lineWidth</code> (number; 6): thickness of lines where new measure starts</li><li><code>textMargin</code> (number; 20): margin to offset time text</li><li><code>cursorColor</code> (string; #0000FF): color used for the time cursor (that scrolls when playing)</li><li><code>cursorWidth</code> (number; 6): width of time cursor line</li></ul></li></ul><p>Dosis is the main font for my Pandaqi brand, that&rsquo;s why.</p><p>This config can also change some more general properties.</p><ul><li><code>audio</code> (object):<ul><li><code>path</code> (string): path to where your audio files are saved (if you want to use a custom structure)</li><li><code>metronomeVolume</code> (number): 0 to 100, how loud the metronome clicks should be</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln>1</span><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>PQ_MIDI</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nx>PQ_MIDI</span><span class=p>.</span><span class=nx>config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=nx>font</span><span class=o>:</span> <span class=p>{</span> <span class=nx>family</span><span class=o>:</span> <span class=s2>&#34;Arial&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=nx>pitch</span><span class=o>:</span> <span class=p>{</span> <span class=nx>emptyPitchesAround</span><span class=o>:</span> <span class=mi>0</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span></span></span></code></pre></div></div></article><div><nav class=pagination><ul><li><a href=/blog/news-and-updates/pandaqi-tutorials-has-been-redesigned/ class="masked-link big-mask mask-2" style=--rotation:1deg>&lt;&lt; Previous Page</a></li><li>Continue reading</li><li><a href=/blog/news-and-updates/pandaqi-games-2023-update/ class="masked-link big-mask mask-6" style=--rotation:2deg>>> Next Page</a></li></ul></nav></div></main><footer id=site-footer><div class="padding center-block"><h3>More Pandaqi</h3><p>You could <a href=https://pandaqi.com>visit the game studio</a>.
Or my <a href=https://pandaqi.com/tutorials/>free tutorial website</a>.
Or my <a href=https://rodepanda.com/>portfolio</a> with easy access to absolutely everything I ever made.</p><h3>Latest</h3><nav class=latest><ul><li><a href=/blog/boardgames/photomone/>Photomone
(üêú)</a></li><li><a href=/blog/boardgames/keebble-domino/>Keebble: Domino
(üìó)</a></li><li><a href=/blog/boardgames/keebble-knickknack/>Keebble: Knickknack
(üìò)</a></li><li><a href=/blog/videogames/game-jams/less-is-store/>Less is Store
(üõçÔ∏è)</a></li><li><a href=/blog/tutorials/placing-grids-within-spaces/>Placing grids within spaces</a></li><li><a href=/blog/boardgames/thats-amorphe-pictures/>That's Amorphe: Pictures
(üñåÔ∏è)</a></li><li><a href=/blog/news-and-updates/pandaqi-games-2023-update-ii/>Pandaqi Games: 2023 Update (II)
(üéÆ)</a></li><li><a href=/blog/news-and-updates/pandaqi-games-2023-update-iii/>Pandaqi Games: 2023 Update (III)
(üéÆ)</a></li><li><a href=/blog/news-and-updates/pq-daw/>PQ_DAW: A music editor for the web
(üéº)</a></li><li><a href=/blog/news-and-updates/pq-words/>PQ_WORDS: A dictionary for games
(üìã)</a></li></ul></nav><h3>Sections</h3><nav><ul><li><a href=/blog/boardgames/>Boardgames
(üé≤)</a></li><li><a href=/blog/news-and-updates/>News & Updates
(üì¢)</a></li><li><a href=/blog/reviews-and-thoughts/>Reviews & Thoughts
(üí≠)</a></li><li><a href=/blog/tutorials/>Tutorials
(üë©‚Äçüéì)</a></li><li><a href=/blog/videogames/>Videogames
(üéÆ)</a></li></ul></nav><h3>Credits</h3><p>Theme by me (<a href=https://pandaqi.com>Pandaqi</a> üêº) &#183;
with ‚ù§Ô∏è &#183;
using <a href=https://gohugo.io>Hugo</a> &#183;
&copy; 2018&ndash;2023 Pandaqi Blog</p></div></footer><link rel=stylesheet type=text/css href=/blog/css/style.css><script src=/blog/js/bundle.min.js></script></body></html>