<!doctype html><html lang=en-US><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>How to deploy a Phaser game as a mobile app (including AdMob) | Pandaqi Blog</title>
<link rel=icon type=image/png href=https://pandaqi.com/blog//favicon.png><link rel=stylesheet type=text/css href=/blog/css/critical.min.css></head><body><header id=site-header><nav class=menu><ul><li><a href=https://pandaqi.com/blog/ class="masked-link big-mask mask-1" style=--rotation:2deg>Home</a></li><li><a href=/blog/boardgames/ class="masked-link big-mask mask-3" style=--rotation:1.5deg>Boardgames</a></li><li><a href=/blog/news-and-updates/ class="masked-link big-mask mask-6" style=--rotation:2deg>News & Updates</a></li><li><a href=/blog/reviews-and-thoughts/ class="masked-link big-mask mask-8" style=--rotation:0deg>Reviews & Thoughts</a></li><li><a href=/blog/tutorials/ class="masked-link big-mask mask-7" style=--rotation:1.5deg>Tutorials</a></li><li><a href=/blog/videogames/ class="masked-link big-mask mask-3" style=--rotation:0.5deg>Videogames</a></li></ul></nav></header><main class="padding center-block"><article class=single-article><h1>How to deploy a Phaser game as a mobile app (including AdMob)</h1><aside class=metadata><nav class=breadcrumbs><span class=metadata-label><span class=emoji>ü•ê</span> Breadcrumbs ||</span>
<a href=https://pandaqi.com/blog/>Home</a>
/
<a href=/blog/>Blog</a>
/
<a href=/blog/tutorials/>Tutorials</a>
/
<a href=/blog/tutorials/deploy-phaser-game-for-mobile/>Deploy phaser game for mobile</a></nav><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/pandaqi.com\/blog\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"\/blog\/","name":"blog"}},{"@type":"ListItem","position":4,"item":{"@id":"\/blog\/tutorials\/","name":"tutorials"}},{"@type":"ListItem","position":5,"item":{"@id":"\/blog\/tutorials\/deploy-phaser-game-for-mobile\/","name":"deploy-phaser-game-for-mobile"}}]}</script><div><span class=metadata-label><span class=emoji>&#8987;</span> Published ||</span>
<time datetime=2024-06-01T00:00:00>Saturday, Jun 1, 2024</time></div><nav class=tags><span class=metadata-label><span class=emoji>üéó</span> Tags ||</span><ul><li><a href=https://pandaqi.com/blog/tags/tutorial>tutorial</a></li></ul></nav><div><span class=metadata-label><span class=emoji>üìñ</span> Table of Contents ||</span>
<a href=# id=toc-toggle>Show</a></div></aside><aside id=table-of-contents class=masked-link-block><header><h2>Table of Contents</h2></header><nav id=TableOfContents><ul><li><a href=#web-wrappers>Web wrappers</a></li><li><a href=#cordova>Cordova</a></li><li><a href=#what-do-i-need-beforehand>What do I need (beforehand)?</a></li><li><a href=#my-way-to-do-it>My way to do it</a></li><li><a href=#the-step-by-step>The step-by-step</a><ul><li><a href=#install-cordova>Install cordova</a></li><li><a href=#create-a-new-cordova-project>Create a new cordova project</a></li><li><a href=#check-the-existing-files>Check the existing files</a></li><li><a href=#adding-your-own-files>Adding your own files</a></li><li><a href=#adding-platforms>Adding platforms</a></li><li><a href=#preparing-for-building>Preparing for building</a></li></ul></li><li><a href=#deploying-the-game>Deploying the game</a><ul><li><a href=#testing>Testing</a></li><li><a href=#debugging>Debugging</a></li><li><a href=#building>Building</a></li><li><a href=#about-keystores>About keystores</a></li><li><a href=#creating-your-own-keystore>Creating your own keystore</a></li><li><a href=#using-your-own-keystore-and-bundling>Using your own keystore (and bundling)</a></li></ul></li><li><a href=#plugins>Plugins</a></li><li><a href=#admob>AdMob</a><ul><li><a href=#create-your-admob-app>Create your AdMob app</a></li><li><a href=#install-the-admob-plugin>Install the AdMob plugin</a></li><li><a href=#displaying-ads-banner>Displaying Ads: Banner</a></li><li><a href=#displaying-ads-rewarded-video>Displaying Ads: Rewarded Video</a></li><li><a href=#getting-consent>Getting consent</a></li></ul></li><li><a href=#the-many-possible-issues>The many possible issues</a><ul><li><a href=#possible-issue-java-naming-is-stupid>Possible Issue: Java naming is stupid</a></li><li><a href=#possible-issue-too-old>Possible Issue: too old</a></li><li><a href=#possible-issue-too-new>Possible Issue: too new</a></li><li><a href=#possible-issue-sdkmanager>Possible Issue: sdkmanager</a></li><li><a href=#possible-issue-no-virtualization>Possible Issue: no virtualization</a></li><li><a href=#possible-issue-package-names>Possible Issue: package names</a></li><li><a href=#possible-issue-no-kotlin>Possible Issue: No Kotlin</a></li><li><a href=#possible-issue-webgl-textures>Possible Issue: WebGL Textures</a></li><li><a href=#possible-issue-meta-policy-tag>Possible Issue: Meta Policy Tag</a></li><li><a href=#possible-issue-delayed-sounds>Possible Issue: Delayed Sounds</a></li><li><a href=#a-tip-icon-and-splash-screen>A tip: icon and splash screen</a></li><li><a href=#a-tip-version-numbering>A tip: version numbering</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></aside><div><p>You have created an HTML5 game. This tutorial mentions Phaser because it&rsquo;s the most-used web game framework, but the process below works for <em>any</em> HTML5 game.</p><p>And now you want to publish and deploy the game for <strong>Android</strong>, probably including support for <strong>ads</strong> (via AdMob).</p><p>I was in the same position. Thus I looked for the easiest way to do it and will now teach that to you!</p><p><em>This guide was written in June of 2024, shortly after major updates to all crucial components. I expect it to be valid for a long time, but be cautious anyway. CapacitorJS also seems a promising alternative and might be evaluated in the future.</em></p><blockquote><p>This should also work for iOS, but you need an Apple device for that. I don&rsquo;t have one, so I can&rsquo;t test it or comment on it further.</p></blockquote><blockquote><p>If you want to build for <em>desktop</em> instead, check out my other tutorial: <a href=../deploy-phaser-game-as-executables/>How to deploy a Phaser game for desktop computers</a>. The start of both tutorials is very similar, then it differentiates.</p></blockquote><h2 id=web-wrappers>Web wrappers</h2><p>A web game is nothing more than a set of files that a web browser can understand and display correctly.</p><p>So how do we turn it into a standalone app? By <em>bundling</em> the game with a web browser! So it doesn&rsquo;t need an external browser anymore!</p><p>This is called a <strong>wrapper</strong>. Such a package wraps <em>around</em> your game files to place them in a simulated web browser.</p><p>And that&rsquo;s good news, because wrappers are always small and easy to use. You&rsquo;ve already done most of the work: creating the <em>actual game</em> and getting <em>all the files ready</em>.</p><p>All that&rsquo;s left is putting it inside the right wrapper with the right configuration.</p><h2 id=cordova>Cordova</h2><p>I used <a href=https://cordova.apache.org/>Apache Cordova</a></p><p>Advantages:</p><ul><li>Probably the most well-known package for this purpose, which also means it&rsquo;s constantly updated and has good plugin support.</li><li>The documentation is well-written and easy to find.</li><li>You can find many other tutorials combining Phaser and Cordova, which means it&rsquo;s probably the most common tool/</li></ul><p>Disadvantages:</p><ul><li>Only mobile export. (Desktop used to be &ldquo;somewhat supported&rdquo;, but that&rsquo;s all deprecated now. See my other tutorial for that.)</li><li>You need lots of Java build tools installed, of precisely the right versions and in the right places. Though that is needed for <em>any</em> Android export and just a nasty part of that ecosystem.</li></ul><h2 id=what-do-i-need-beforehand>What do I need (beforehand)?</h2><p>Cordova isn&rsquo;t software to install. It&rsquo;s a <em>node package</em>. So <a href=https://nodejs.org/en/download/>install Node</a></p><p>I recommend <a href=https://code.visualstudio.com/>Visual Studio Code</a> for editing the code and running the commands.</p><p>It has an integrated terminal or command line. When you add a folder to the workspace, you can right-click and choose &ldquo;open integrated terminal here&rdquo;. It&rsquo;s an easy way to type commands inside any project.</p><p>And lastly, I recommend installing <a href=https://desktop.github.com/>GitHub Desktop</a> and making an account at GitHub. Git is a <em>versioning</em> tool. This means it keeps track of all your changes. When done with a feature, you can commit those changes to create a backup on GitHub. If anything goes wrong, you have an older version to go back to.</p><aside class="remark masked-link-block"><span class=label>Remark ||</span><p>If you do so, go to the option &ldquo;Git Ignore&rdquo; and choose the &ldquo;Node&rdquo; template. This ensures git ignores the <em>many, many</em> modules that every node project will install. Which would slow down versioning and backup by a ton.</p></aside><h2 id=my-way-to-do-it>My way to do it</h2><p>You <em>could</em> create this wrapper around <em>every project you make</em>. In other words, whenever you start a new web game, also install cordova again, configure it again, so it&rsquo;s integrated with the project.</p><p>But I don&rsquo;t like that. It adds a lot of overhead and complexity to any game.</p><p>I only care about cordova at the final stage: the game is <em>done</em> and I want to <em>deploy it</em>. The other 99,9% of the time it has no business being in that game project folder.</p><p>My technique is therefore to create a <strong>single, separate Cordova project</strong>. When I want to deploy something, I simply copy-paste all its files to this Cordova project and run it once. This neatly <em>separates</em> the development and coding step, from the building and exporting step.</p><p>This won&rsquo;t work if all your games are radically different in terms of <em>configuration</em>. But most likely, they are all radically <em>exactly the same</em> :p</p><h2 id=the-step-by-step>The step-by-step</h2><p>First, I&rsquo;ll give you the step-by-step of how it <em>should</em> work. Then, I&rsquo;ll go over the many things that can go wrong or might be relevant for your specific use case.</p><h3 id=install-cordova>Install cordova</h3><p>Because it&rsquo;s a node package, we can add Cordova now with a single line of code.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>npm install -g cordova</span></span></code></pre></div><p>This installs it <em>globally</em>. This simply means that you can now use the <code>cordova</code> keyword within any node project, like the one we just created, to accomplish stuff.</p><p>This is &ldquo;Cordova CLI&rdquo;: Cordova Command Line Interface. Apparently there are other versions, mostly in the past. But this can be really confusing when you look up issues or documentation, as it might be talking about a <em>different</em> version. So keep that in mind.</p><h3 id=create-a-new-cordova-project>Create a new cordova project</h3><p>Determine where you want to store this project.</p><p>I have a &ldquo;Games&rdquo; folder at the top level of my computer, with all games in it (duh). This cordova template could be used by anything, so it&rsquo;s at the root of that folder.</p><p>Go to that location in the command line.</p><p>As stated, you can do so in VS Code (right-click on this folder and open a terminal there). You can also simply open the command line utility of your operating system and type <code>cd &lt;path-to-folder></code> to <em>change directory</em></p><p>Now we use that <code>cordova</code> keyword to create a new project of the right type.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova create foldername packagename projectname</span></span></code></pre></div><p>Those three names must be supplied by you:</p><ul><li>Foldername = the name of the folder containing the cordova skeleton, which I&rsquo;ll call <code>cordova-export</code></li><li>Packagename = required for mobile apps, has the form <code>com.developername.gamename</code></li><li>Projectname = the title of your project and app</li></ul><p>Within a few seconds, it has created that folder. Within it resides the <em>skeleton</em> for any cordova app.</p><p>Note two important files: <code>package.json</code> and <code>config.xml</code>. You can <strong>change both at any time</strong>.</p><ul><li>The <code>package.json</code> file has some of the more general information you just entered.</li><li>The <code>config.xml</code> file contains more specific information about how to build the app and how it should function. For example, this is where you need to put some lines of code to make AdMob work.</li></ul><p>This is how you can easily use this <em>one</em> project for <em>all</em> your web game exports. For each game, simply save its own <code>package.json</code> file with the right parameters and its own <code>config.xml</code> with the right parameters.</p><p>When it&rsquo;s time to deploy, swap out the files, and your settings (title, version, author, etcetera) should be correct. One cordova project&mdash;use it to export any of your projects.</p><h3 id=check-the-existing-files>Check the existing files</h3><p>The <code>www</code> folder contains the content of the app. For now, it has a very small demo project.</p><p>There are several lines of importance in <code>index.html</code>:</p><ul><li>The meta tags in the head. Copy them to the <code>index.html</code> of your own game.</li><li>The inclusion of a script <code>cordova.js</code> at the end of the body. Copy this line of code to your own <code>index.html</code>, at the end of the body.</li></ul><p>The cordova script is used by cordova to add extra functionality to your game. You might be able to do without it, but there&rsquo;s no reason not to just include it.</p><p>There is also a <code>js/index.js</code> file. It has boilerplate code that allows checking if your app is ready to go. You might want to copy this to your game as well, or save it for later, as you&rsquo;ll need this for the AdMob integration.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Javascript data-lang=Javascript><span class=line><span class=ln>1</span><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;deviceready&#39;</span><span class=p>,</span> <span class=nx>onDeviceReady</span><span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=kd>function</span> <span class=nx>onDeviceReady</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=c1>// Cordova is now initialized. Have fun!
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1></span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Running cordova-&#39;</span> <span class=o>+</span> <span class=nx>cordova</span><span class=p>.</span><span class=nx>platformId</span> <span class=o>+</span> <span class=s1>&#39;@&#39;</span> <span class=o>+</span> <span class=nx>cordova</span><span class=p>.</span><span class=nx>version</span><span class=p>);</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;deviceready&#39;</span><span class=p>).</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;ready&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>}</span></span></span></code></pre></div><h3 id=adding-your-own-files>Adding your own files</h3><p>After learning what you can from the demo project, you can &mldr;</p><ul><li>Remove that whole demo project!</li><li>Copy-paste your web game into it. Make sure your main file is also called <code>index.html</code></li></ul><p>It&rsquo;s that simple. Now cordova will load your game just like a browser would.</p><h3 id=adding-platforms>Adding platforms</h3><p>We need to tell cordova to which platforms it should export. For this tutorial, I&rsquo;ll keep it simple and stay with Android.</p><p><strong>Go inside the cordova folder</strong> (in the command line). You can use <code>cd cordova-export</code> for that in the terminal. Then type &mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova platform add android</span></span></code></pre></div><p>It might take a while. Wait until it&rsquo;s done. Check it worked:</p><ul><li>A <code>node_modules</code> folder was added</li><li>A <code>platforms</code> folder was added, containing an <code>android</code> folder.</li><li>The <code>package.json</code> file was updated to indicate the platform android.</li></ul><h3 id=preparing-for-building>Preparing for building</h3><p>This is the &ldquo;nasty&rdquo; step I mentioned when it comes to android. It requires some very huge and slow-to-install android tools. There are <em>many things that can go wrong</em>.</p><p>You can check if you have all the requirements by typing <code>cordova requirements</code> (still inside the project folder, so it knows what cordova project to check). It will tell you exactly what you have and what you&rsquo;re missing.</p><p>The <a href=https://cordova.apache.org/docs/en/12.x/guide/platforms/android/index.html#requirements-and-support>Cordova docs</a> outline how to get every required part.</p><p>I don&rsquo;t see a reason to copy this to my tutorial. Read that guide from top to bottom and you should have (and understand) everything needed.</p><p>But let me give you a summary. In a later section, I&rsquo;ll also explain all the many things that went wrong for me. Because I am truly the champion of hitting every possible obstacle when trying something new.</p><ul><li>Java Development Kit (JDK) => the toolkit to make Java (programming language, used to build Android) work. At this moment, download OpenJDK 17.</li><li>Gradle => building, package and version manager for all this android stuff (similar to NPM). A bunch of files to unzip and place on your computer.</li><li>Android SDK => the toolkit to make building to Android work.</li><li>Android target => each version of android needs its own settings and tools.</li></ul><p>Both SDK and targets are best acquired by installing the latest version of <em>Android Studio</em>. It should install or update the latest versions automatically.</p><p>Even so, once installed, you still need to start the software and go to <strong>More Options > SDK Tools</strong>. It gives a giant list of all possible things to install, and the Cordova guide tells you which of those boxes to tick sand install too.</p><p>All of these need to be specified in the system <code>PATH</code>. So that the terminal can actually find them.</p><p>During this process, keep trying and typing <code>cordova requirements</code>. Once it&rsquo;s completely happy, you are ready to continue!</p><p><strong>You probably need to restart Visual Studio code (or the command line) after every try</strong>. The path/system variables are only read and stored when a terminal/command program <em>starts</em>. So if it&rsquo;s already running, and you change something, it won&rsquo;t see it (yet).</p><h2 id=deploying-the-game>Deploying the game</h2><h3 id=testing>Testing</h3><p>You&rsquo;ll do most of your game debugging simply in Phaser 3 / in your browser, of course. But you still need to regularly check if the mobile export works as intended.</p><p>That&rsquo;s why cordova can <em>emulate</em> the game, as a mobile app, right on your computer.</p><p>Cordova uses the &ldquo;virtual devices&rdquo; setup by Android Studio. There should be a suitable one by default. But in case anything went wrong, you can <a href=https://developer.android.com/studio/run/managing-avds.html>add and change virtual devices yourself</a></p><p>To <em>emulate</em> your game right on your computer, type <code>cordova emulate android</code>.</p><p>This opens a window with your game, as seen through a specific phone model. It also includes some extra buttons/UI you&rsquo;d commonly find on phones.</p><p><strong>Emulation is extremely tough on a computer.</strong> My crappy old laptop couldn&rsquo;t use it. Any hardware I borrowed, no matter how new or fast (normally), couldn&rsquo;t use it. It took 10+ minutes to start, and then it just loaded and lagged and loaded.</p><p>As such, I actually <strong>recommend just testing on your smartphone</strong>.</p><ul><li>Ensure your smartphone has <em>USB debugging</em> enabled. (Enable dev tools on your android phone, then plug it into your device and accept. You can find guides online, but it often depends on your specific model.)</li><li>Plug it into your computer.</li><li>Then type <code>cordova run android</code> and it should automatically install and run it to your device.</li></ul><p>This lets me reliably test/debug the game within 3 seconds, even with a crappy old Android phone.</p><h3 id=debugging>Debugging</h3><p>Now we get to another great feature of the &ldquo;web app => mobile app&rdquo; workflow.</p><p>With your phone connected to your computer, you can use Chrome to <em>inspect</em> the game.</p><ul><li>Go to <code>chrome://inspect/#devices</code></li><li>Start the game, wait a few seconds.</li><li>It should show up as a &ldquo;web view&rdquo;.</li><li>Now you can click <em>inspect</em> below it, to inspect the game just like you&rsquo;d inspect/debug a web page.</li><li>You get all the debug/error/console messages and the actual HTML tree.</li><li>(You can even play the game, on your phone, through your computer! Gameception.)</li></ul><p>This was <em>essential</em> to debugging many of my errors mentioned below. It&rsquo;s fast, it&rsquo;s easy, and it allows lots of insight into what&rsquo;s happening and why the game isn&rsquo;t working (as expected).</p><h3 id=building>Building</h3><p>Once you&rsquo;re certain the app/game is how you want it to be, you can build it and deploy it to the common stores.</p><p>With all this setup done, building is just one command: <code>cordova build</code></p><p>It will setup a gradle (this might take a while). Once done, it uses that to build the game (this is very quick).</p><p>The output is within <code>platforms/android/app/build/outputs</code>. Yeah, it&rsquo;s a very long path. Just CTRL + Click on the path in your terminal and VS Code brings you to it.</p><p>A few important notes:</p><ul><li>This signs the app using a debug key. If you want to deploy it, you need to create your own key and sign it with that.</li><li>It defaults to exporting an <code>.apk</code> This is somewhat deprecated and Google Play wants an <code>.aab</code> now.</li></ul><p>Both these steps will be discussed now, but you can skip them if you&rsquo;re just playing around for now and won&rsquo;t publish the app anywhere soon.</p><h3 id=about-keystores>About keystores</h3><p>Mobile apps use <em>keystores</em> to sign an app. They encrypt your app and prove they come from <em>you</em>. (Without these details, people can&rsquo;t look inside your app, and can&rsquo;t deploy their own apps <em>as if they were made</em> by you.)</p><p>It&rsquo;s called a keystore because it can hold <strong>multiple keys</strong> for <strong>multiple projects</strong>.</p><p>This is a fact I was stupid enough to ignore. So my first 10&ndash;20 projects all used <em>their own keystore</em> for only <em>their own key</em>, which created an unncessary mess.</p><p>As such, I recommend creating one keystore, keeping it in a safe place you can easily find, and using it for all projects you export to android.</p><h3 id=creating-your-own-keystore>Creating your own keystore</h3><p>There are two steps to create a single keystore in the first place.</p><ul><li>Create the keystore file</li><li>Then provide a password to unlock the <em>file</em>.</li></ul><p>If that&rsquo;s done, you can do this step <em>as many times as you want</em>:</p><ul><li>Add an alias ( = name for a new key-password entry)</li><li>And a password for that alias</li></ul><p>It&rsquo;s best to make a new alias for each game.</p><p>How do you do this? Well, you already went through all the trouble of installing those Java and Android tools. As such, you already have everything you need!</p><p>In the command below, the ALIAS must be something you invent yourself. When executed, it will ask you some questions, such as the password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>keytool -genkey -v -keystore android_game_keys.keystore -alias ALIAS -keyalg RSA -keysize <span class=m>2048</span> -validity <span class=m>100000</span></span></span></code></pre></div><p>The last arguments are common, but can be changed. RSA is simply the strongest encryption, you probably don&rsquo;t need more than 2048 keys in one keystore, and validity is just some <em>very high number of days</em>.</p><p>If you want to add a second alias, simply retype the command (with the same keystore), but change the alias. (It should only ask your password once, not twice, which is a sign you&rsquo;re adding to an existing keystore.)</p><h3 id=using-your-own-keystore-and-bundling>Using your own keystore (and bundling)</h3><p>You specify the <em>key</em> and the <em>export type</em> in the command line, after <code>cordova build</code>.</p><ul><li><code>--packageType bundle</code> will export it as an <code>.aab</code></li><li><code>--keystore path/to/keystore</code></li><li><code>--storePassword pwd</code></li><li><code>--alias</code> the private key to use for signing</li><li><code>--password</code> the password for that private key</li></ul><p>For example,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova build android --packageType bundle --keystore path/to/android_game_keys.keystore --storePassword <span class=m>1234</span> --alias myGame --password <span class=m>12345</span></span></span></code></pre></div><p>Now your app is <em>properly signed</em> and has the <em>proper bundle format</em>. This app could be distributed through the Google Play store!</p><p>The next sections will talk about how to expand the functionality through plugins, focusing on the common AdMob for showing ads.</p><h2 id=plugins>Plugins</h2><p>By default, cordova will merely wrap your game inside a browser environment. For many games, this will be fine. They only need common browser features that don&rsquo;t depend on the device used.</p><p>But this means you don&rsquo;t have access to smartphone features like a native app: camera, media access, GPS, battery status, etcetera</p><p>To change this, cordova uses <strong>plugins</strong>. You can <a href=https://cordova.apache.org/plugins/>search the plugin list</a>.</p><p>Once you know what you need, copy the package name and type &mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova plugin add pluginname</span></span></code></pre></div><p>For example, you need a plugin to use the <em>camera</em> of a phone. These are installed into a <code>plugins</code> folder. Check which plugins are installed using the common <code>ls</code> ( = &ldquo;list&rdquo;) command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova plugin ls</span></span></code></pre></div><p>For games, it&rsquo;s common to lock the screen orientation. (It&rsquo;s unlikely your game can be played in both orientations.) That&rsquo;s a smartphone-specific functionality, so it needs a plugin!</p><p>Add it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova plugin add cordova-plugin-screen-orientation</span></span></code></pre></div><p>And lock the game into a mode through JavaScript, landscape for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>screen.orientation.lock<span class=o>(</span><span class=s1>&#39;landscape&#39;</span><span class=o>)</span><span class=p>;</span></span></span></code></pre></div><p>Or read the <a href=https://cordova.apache.org/docs/en/12.x/reference/cordova-plugin-screen-orientation/>full docs for the screen orientation plugin</a>.</p><h2 id=admob>AdMob</h2><p>A very common addition to mobile games are <em>ads</em>, and more specifically AdMob. Over the years, however, this has become increasingly <em>complicated</em>. What used to be a simple step now has loads of extra rules, partially from governments (privacy regulations and such), partially from AdMob itself who is terribly afraid anyone might use it in the wrong way.</p><p>So let&rsquo;s keep it simple and go over each step.</p><h3 id=create-your-admob-app>Create your AdMob app</h3><p>This is still rather straightforward.</p><ul><li>Get an AdMob account.</li><li>Create a new app with the name of your game.</li><li>Create the ad blocks you need. (For our example purposes here, I went with a simple banner and then the more complicated rewarded video.)</li><li>After creating them, you get two IDs in return: the ADBLOCK id (with a <code>/</code>) and the APP id (with a <code>~</code>).</li></ul><p>It&rsquo;s not required to give a link to the app in the play store here. While the game isn&rsquo;t finished yet, just use AdMob&rsquo;s test ads. You can find an <a href=https://admob-plus.github.io/docs/cordova/test-ads>overview of AdMob test IDs here</a>.</p><p>Once it&rsquo;s finished, switch to your <em>real</em> ad id. Then upload your game to the store and update the link to it. (If not connected to a &ldquo;supported store&rdquo;, real ads simply won&rsquo;t show.)</p><p>I recommend storing your IDs in an easy-to-reach location within your project, as well as the Google test IDs. For example,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Javascript data-lang=Javascript><span class=line><span class=ln>1</span><span class=cl><span class=kr>const</span> <span class=nx>admobConfig</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=nx>banner</span><span class=o>:</span> <span class=s2>&#34;ca-app-pub-xxx/xxx&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=nx>bannerTesting</span><span class=o>:</span> <span class=s2>&#34;ca-app-pub-xxx/xxx&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=nx>interstitial</span><span class=o>:</span> <span class=s2>&#34;ca-app-pub-xxx/yyy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=nx>rewarded</span><span class=o>:</span> <span class=s2>&#34;ca-app-pub-xxx/yyy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    <span class=c1>// etcetera
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=c1></span><span class=p>};</span></span></span></code></pre></div><p>You will need these anyway in the final game. But this also makes it easy to switch or turn testing on/off all the time.</p><h3 id=install-the-admob-plugin>Install the AdMob plugin</h3><p>Fortunately, there is another package for this: <a href=https://www.npmjs.com/package/admob-plus-cordova>Cordova Admob</a></p><p>The <a href=https://admob-plus.github.io/docs/cordova>documentation on this package</a> is mostly pretty great, with some exceptions.</p><p>Install it, still in the same terminal and project, using the regular syntax. Also give it the APP id (with the tilde symbol, <code>~</code>) here to save it already.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>cordova plugin add admob-plus-cordova --save --variable <span class=nv>APP_ID_ANDROID</span><span class=o>=</span><span class=s2>&#34;your APP id here&#34;</span></span></span></code></pre></div><p>Once done, you&rsquo;ll notice it has added your ID to a file <code>plugin.xml</code>, inside of <code>plugins/admob-plus-cordova</code>.</p><p>If you, like me, use a single project for all your games, you&rsquo;ll need to keep a unique <code>plugin.xml</code> for each game with the right ID. You can simply copy this file and edit as you like.</p><p>With this added, calling AdMob is a matter of writing a few lines of JavaScript.</p><aside class="remark masked-link-block"><span class=label>Remark ||</span><p>I recommend coding projects to be platform-agnostic. So, wrap your calls and functionality based on AdMob in something that <em>checks if it exists</em>. And if not, gracefully ignore/hide that functionality. This way, you can use the exact same project, but export it to many platforms without issues.</p></aside><h3 id=displaying-ads-banner>Displaying Ads: Banner</h3><p>This plugin isn&rsquo;t started automatically (which I explain below). It also can&rsquo;t do anything until the device is <em>ready</em>.</p><p>As such, all this functionality needs to wait for that <code>deviceready</code> signal. Then it has to wait for admob to start. But once that&rsquo;s done, you&rsquo;re good to go and it works very simply.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln> 1</span><span class=cl><span class=kd>let</span> <span class=nx>banner</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;deviceready&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=kr>await</span> <span class=nx>admob</span><span class=p>.</span><span class=nx>start</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=nx>banner</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>admob</span><span class=p>.</span><span class=nx>BannerAd</span><span class=p>({</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=nx>adUnitId</span><span class=o>:</span> <span class=s1>&#39;ca-app-pub-xxx/yyy&#39;</span><span class=p>,</span> <span class=c1>// get this ID from the ones you saved
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=c1></span>    <span class=p>})</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=kr>await</span> <span class=nx>banner</span><span class=p>.</span><span class=nx>show</span><span class=p>()</span>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=p>},</span> <span class=kc>false</span><span class=p>)</span></span></span></code></pre></div><p>This will show a banner at the bottom (by default, you can customize this) that automatically refreshes for a new banner once in a while.</p><h3 id=displaying-ads-rewarded-video>Displaying Ads: Rewarded Video</h3><p>This is similar, but with a few extra notes.</p><p>Any bigger ad types (so almost anything except for the banner) need <em>time</em> to find one and load it. As such, you can&rsquo;t just tell it to display something immediately and expect it to work.</p><p>Instead, you need the constant cycle of &ldquo;load new ad -> once ready, allow showing it&rdquo;.</p><p>In code, this looks as follows.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln> 1</span><span class=cl><span class=kd>let</span> <span class=nx>rewarded</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;deviceready&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=kr>await</span> <span class=nx>admob</span><span class=p>.</span><span class=nx>start</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=nx>rewarded</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>admob</span><span class=p>.</span><span class=nx>RewardedAd</span><span class=p>({</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=nx>adUnitId</span><span class=o>:</span> <span class=s1>&#39;ca-app-pub-xxx/yyy&#39;</span><span class=p>,</span> <span class=c1>// get this id from the ones you saved
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=c1></span>    <span class=p>})</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=c1>// make sure we always load the next one in advance
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=c1></span>    <span class=c1>// (for example, when the previous one is done loading)
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=c1></span>    <span class=nx>rewarded</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;load&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>ev</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=kr>await</span> <span class=nx>rewarded</span><span class=p>.</span><span class=nx>load</span><span class=p>()</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl>    <span class=c1>// load the first one
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=c1></span>    <span class=kr>await</span> <span class=nx>rewarded</span><span class=p>.</span><span class=nx>load</span><span class=p>()</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>
</span></span><span class=line><span class=ln>20</span><span class=cl>    <span class=c1>// then, use this function (whenever needed in your game) to show cached ads
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=c1></span>    <span class=kr>await</span> <span class=nx>rewarded</span><span class=p>.</span><span class=nx>show</span><span class=p>()</span>
</span></span><span class=line><span class=ln>22</span><span class=cl><span class=p>},</span> <span class=kc>false</span><span class=p>)</span></span></span></code></pre></div><h3 id=getting-consent>Getting consent</h3><p>Since a few years now, privacy regulations have required asking consent or storing permissions before showing ads.</p><p>You can technically get away with not doing it (if you&rsquo;re a small game that won&rsquo;t be noticed), but that is also technically illegal now in certain areas of the world (mostly EU). This should be communicated and handled much more clearly by AdMob, but alas, here we are.</p><p>To support this,</p><ul><li>Go to your AdMob account > Privacy & Messaging > Determine your settings and create messages for each of the regulations listed.</li><li>Visit this page and do as it says: <a href=https://admob-plus.github.io/docs/cordova/consent>Cordova Consent</a></li><li>Install the plugin, copy the code (before displaying ads), and you should be good to go.</li></ul><p>While debugging, just completely leave this out. It <em>should</em> recognize you don&rsquo;t need consent then and skip it, but in my experience this will still hinder your app, for example because you haven&rsquo;t set it up in AdMob yet and now it can&rsquo;t <em>find</em> the consent messaging for it and thus crashes.</p><p>I am still learning about this. I&rsquo;ve been away from all of this for a while and this was also new to me, so maybe I got some things wrong or I&rsquo;m missing crucial parts here.</p><p>Honestly, it&rsquo;s a mess. Nobody actually cares about this. If you really don&rsquo;t want to be tracked, you don&rsquo;t play games with ads, you block ads, you probably don&rsquo;t come near most of the internet or gaming. For anybody else, this is just extra steps for developers <em>and</em> extra steps for users to reach the same state as before.</p><p>(Similar to how all websites in the EU are now forced to display a message asking your permission to use cookies, and everyone blindly accepts immediately&mdash;with frustration&mdash;or installs an extension to do that for them.)</p><p>Don&rsquo;t waste your breath on this. Get ads working, create a good game, worry about this at the end.</p><h2 id=the-many-possible-issues>The many possible issues</h2><h3 id=possible-issue-java-naming-is-stupid>Possible Issue: Java naming is stupid</h3><p>The JDK has <em>versions</em> that are integers. Like: JDK v17.</p><p>But when you download them, and unzip their folder, their version has a <em>product id</em>. Like: 11.0.17</p><p>The last element of the product ID is the actual JDK version. This is confusing. Now you know.</p><p>Also, since some years, you need an account to download Java executables. This is a stupid money-hungry move from Oracle that is clearly not in the best interest of the <em>users</em>. Simply go to OpenJDK instead, which has the exact same executables, but listed more clearly and, of course, openly available!</p><h3 id=possible-issue-too-old>Possible Issue: too old</h3><p>For some reason, when I went to &ldquo;latest&rdquo; downloads for both Gradle and JDK (Java Development Kit) &mldr; I did <em>not</em> get the latest downloads.</p><p>The current version of Cordova (v12) needs JDK 17 and Gradle 7+. Make sure you download those. In case of doubt, just download <em>several different JDK versions</em> and try until one works. This isn&rsquo;t a weird approach&mdash;it&rsquo;s basically the expected process when it comes to working with Java. Even the developers agree to just try them all and see which ones are supported.</p><p>Also make sure the <code>PATH</code> points to them.</p><p>Actually, there are <em>two</em> different ;locations where things need to be added.</p><ul><li>The <strong>System Variables</strong>, in the lower box. These need a path <strong>and</strong> a name. The JDK must be saved there under <code>JAVA_HOME</code>. The Android SDK must be saved there under <code>ANDROID_HOME</code>. (This used to be <code>ANDROID_SDK_ROOT</code>, but that is deprecated now and will be gone some time in the future.)</li><li>The general <strong>PATH</strong> variable, which is just ONE entry in the upper box. Double-click it to get another submenu for editing the PATH one by one.<ul><li>Supply paths to folders. All scripts/executables inside the folder are now known to the terminal.</li><li>Everything else must be set <em>here</em>.</li></ul></li></ul><h3 id=possible-issue-too-new>Possible Issue: too new</h3><p>Cordova is often updated, but Android has to be updated <em>first</em>. It might happen that you download these at a weird time (like me!) and get a version that is <em>too new</em>. For example, Cordova only supports until Android v13, but my Android Studio defaulted to the latest Android v14.</p><p>Then you need to install a few older Android targets that Cordova recognizes. Do so from within that SDK Manager on the Android Studio home screen.</p><h3 id=possible-issue-sdkmanager>Possible Issue: sdkmanager</h3><p>In the guide, it also tells you to add four other executables to the <code>PATH</code></p><ul><li><code>cmdline-tools/latest/bin</code></li><li><code>emulator</code></li><li><code>platform-tools</code></li><li><code>build-tools</code></li></ul><p>It pretends this is a &ldquo;nice thing to do&rdquo;. No, it is <strong>essential</strong>.</p><p>And don&rsquo;t forget the <code>/bin</code> at the end.</p><p>You can test this works by using the <code>sdkmanager</code> command. If you type it and get an error, your path variables are wrong.</p><aside class="remark masked-link-block"><span class=label>Remark ||</span><p>This error is most likely <em>not</em> a nice readable one. In my case, it was a generic Java error about some exception it raised. It was generic enough that Googling it resulted in hundreds of results that were NOT about cordova at all.</p></aside><p>Don&rsquo;t get an error? It works properly. And you can use this command to get information!</p><ul><li>Type <code>sdkmanager --list</code> to get a list of all installed Android targets.</li><li>Or type <code>sdkmanager --install "sometarget"</code> to install something new (without needing to go through Android Studio).</li></ul><p>If this command reports you have some targets, cordova <em>should</em> be able to find them and be happy.</p><h3 id=possible-issue-no-virtualization>Possible Issue: no virtualization</h3><p>Cordova couldn&rsquo;t emulate anything, in my case. It would just crash or not find anything to emulate.</p><p>When I checked the virtual devices in Android Studio, there was one default device! But it had a big red message from Android Studio saying &ldquo;VT-x disabled in BIOS&rdquo;.</p><p>Apparently, &ldquo;virtualization&rdquo; is something that can be enabled/disabled in your BIOS. And it was disabled in mine by default. So I looked up what that was and how to enable it.</p><p>Once I did that, stuff worked. I was actually surprised by this.</p><h3 id=possible-issue-package-names>Possible Issue: package names</h3><p>Each game requires its own unique package name, preferably something that fits and is easy to recognize.</p><p>As stated, you had to give the package name when creating the Cordova project in the first place. So &mldr; how can you change it later? How can you give each app a unique ID when they all use that same Cordova project?</p><p><strong>Not</strong> by renaming it in <code>config.xml</code> (or anywhere else). No no! You need to replace it <em>everywhere</em> throughout the entire cordova project AND rename the java folder that contains the root file. Otherwise the entire thing <em>breaks</em> and refuses to do anything.</p><p>But I don&rsquo;t recommend doing that too, as it&rsquo;s a lot of work and error prone.</p><p>There&rsquo;s a much simpler solution: add <code>android-packageName="com.whatever.name"</code> to the main tag in <code>config.xml</code>. The tag that also specifies the original package name at the start.</p><p>This means you don&rsquo;t need to change anything else. You can still use a unique config file per game and that&rsquo;s all. But it will export the game with the right details behind the scenes.</p><aside class="remark masked-link-block"><span class=label>Remark ||</span><p>And the Play Store is <em>very</em> particular about package names. If you accidentally upload a first version with the wrong one, you can <em>never</em> remove it again, only deactivate it. So now your dashboard is forever cluttered with minor mistakes from the past. Not speaking from experience, not at all.</p></aside><h3 id=possible-issue-no-kotlin>Possible Issue: No Kotlin</h3><p>Remember when I said the docs for the AdMob plugin were great &mldr; with some exceptions? This is one of them.</p><p>(Another is the fact Test Ads and Consent are only mentioned <em>after</em> explaining the entire system front to end, which probably caused newer developers to accidentally use real ads or do something against AdMob policy. Or get no ads at all, more likely, and think they did something wrong when they didn&rsquo;t really.)</p><p>This is mentioned absolutely nowhere and is 100% crucial: <strong>you need Kotlin enabled</strong> for AdMob to work.</p><p>Add these three lines to your <code>config.xml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=ln>1</span><span class=cl><span class=nt>&lt;platform</span> <span class=na>name=</span><span class=s>&#34;android&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=nt>&lt;preference</span> <span class=na>name=</span><span class=s>&#34;GradlePluginKotlinEnabled&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nt>&lt;/platform&gt;</span></span></span></code></pre></div><p>That&rsquo;s it. This was the difference between <em>nothing</em> happening and everything working flawlessly, at least for me.</p><p>How did I figure this out? There is a short <em>upgrade</em> guide when going from v1 to v2 which mentions this. But I never used v1, so how was I supposed to know? :p</p><h3 id=possible-issue-webgl-textures>Possible Issue: WebGL Textures</h3><p>At first, when I exported the game, the entire screen was just black. I upped the brightness and saw it was not a uniform black&mdash;not a crash, no, I could play the actual game&mdash;but all the images had turned to blackish rectangles.</p><p>As it turns out, WebGL&rsquo;s minimum requirement on texture size support is <code>4096x4096</code>. You can be sure this is supported by all devices, but you can <em>not</em> be sure about anything higher than that!</p><p>Well, having made loads of board games (at super high resolution) the past few years, my original spritesheets were two images with a width double that (8192px). They refused to render.</p><p>I shuffled the spritesheet around to be under the minimum size (and reduced the size overall, as such high resolution is not needed on a web game :p) and then the game exported flawlessly to my Android phone.</p><h3 id=possible-issue-meta-policy-tag>Possible Issue: Meta Policy Tag</h3><p>Some people have reported the need to add &ldquo;blob&rdquo; type to the security policy (when using Phaser). I didn&rsquo;t need to at first, but I <em>did</em> need it after some updates came through.</p><aside class="remark masked-link-block"><span class=label>Remark ||</span><p>I&rsquo;m not sure if an update to Phaser, Cordova or Java caused it. In any case, it&rsquo;s related to making your app more secure by disallowing most asset types, and only allowing what&rsquo;s needed.</p></aside><p>To solve this, add this exact tag to the head of your <code>index.html</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln>1</span><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http-equiv</span><span class=o>=</span><span class=s>&#34;Content-Security-Policy&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;default-src &#39;self&#39; data: https://ssl.gstatic.com &#39;unsafe-eval&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;;  media-src *; img-src &#39;self&#39; data: content: blob:;&#34;</span><span class=p>&gt;</span></span></span></code></pre></div><p>If this still doesn&rsquo;t work, just remove the <em>entire</em> Content-Security-Policy tag for now. This will allow all assets and is the easiest way to just get a game up and running for now. For a simple game, the extra security it brings is not needed.</p><h3 id=possible-issue-delayed-sounds>Possible Issue: Delayed Sounds</h3><p>This is a general issue with web audio and how browsers handle it. Processing and displaying audio is far more complex than people think. A lot can go wrong, it can be resource intensive, and support for it has been more flaky than it has been for graphics/video.</p><p>When I exported my Phaser game, the sound was severely delayed on my phone. I&rsquo;m talking about 0.5-1.0 second after the sound was <em>supposed</em> to trigger. (And yes, it played instantly on my computer.)</p><p>I wasn&rsquo;t sure if this was just my terrible hardware (as usual) or a persistent issue, because I could not find <em>any</em> mention online of this specific issue. Only some more generic audio issues with Phaser/Cordova with completely different origins/solutions.</p><p>There are two solutions here: use the Cordova Media plugin instead (to natively play audio), or use the Howler.js library (which many seem to use by default for audio in any web project)</p><p>I&rsquo;ve mentioned that I want projects to be platform-agnostic, so I want the game to be entirely self-contained and not rely on <em>any</em> Cordova functionality or bindings. So I chose the second option and simply rewrote the few Phaser audio calls to howler.</p><p>This was very <em>easy</em> and <em>fast</em>, and I immediately liked this HowlerJS library.</p><p>It did not solve the problem at all, however. I could not find a cause for this and it only happens on some (mobile, cheaper) devices, so I had to leave this alone for now.</p><h3 id=a-tip-icon-and-splash-screen>A tip: icon and splash screen</h3><p>This is another very crucial aspect&mdash;delivering the right icon and boot image for your app&mdash;that is handled extremely poorly in the docs.</p><p>It&rsquo;s actually quite simple, once you figured it out.</p><p>As usual, all of this code is to be added in the <code>config.xml</code> file.</p><p>The following code sets the icon for all sizes and platforms.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=ln>1</span><span class=cl><span class=nt>&lt;icon</span> <span class=na>src=</span><span class=s>&#34;path/to/icon.png&#34;</span><span class=nt>&gt;</span></span></span></code></pre></div><p>The following code sets the splash screen to something else (instead of the default cordova box icon).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=ln>1</span><span class=cl><span class=nt>&lt;preference</span> <span class=na>name=</span><span class=s>&#34;SplashScreenAnimatedIcon&#34;</span> <span class=na>value=</span><span class=s>&#34;path/to/icon.png&#34;</span> <span class=nt>/&gt;</span></span></span></code></pre></div><p>Of course, you can set different icons for different sizes, or apply something more advanced (such as the multi-layered adaptive icons that Android wants you to make). But I like things simple and clean and I don&rsquo;t care about that, so this was enough for me.</p><p><strong>Note</strong> that the path to this icon is from the <strong>root</strong> of the project, <em>not</em> that <code>www</code> folder that contains your actual game. As such, it&rsquo;s recommended to create a <code>res</code> or <code>resources</code> folder at the root and put all those extra assets in that.</p><h3 id=a-tip-version-numbering>A tip: version numbering</h3><p>The Play/App Store require that every new update to your app uses a <em>higher</em> version number than the previous one. This is baked into the app file itself and must, thus, be manually updated and set accordingly before building it in the first place.</p><p>This, again, can be done in the <code>config.xml</code>.</p><p>The default one should already contain a <code>version="1.0.0"</code> line. You might know, however, that app versioning uses <em>integers</em> (and not the dot-format of other software).</p><p>But don&rsquo;t worry! Cordova <em>automatically</em> converts this version to an integer format. More specifically, it does <code>10000 * first number + 100 * second number + third number</code></p><p>For example, if you don&rsquo;t change anything, your first release will have version number 10000. If you then change it to <code>1.1.0</code>, it will be 10100.</p><p>So all you need to do, whenever you publically release a new version of your game, is ensure you bumped this one version property, in this one place, to something higher. It should all work out properly then.</p><h2 id=conclusion>Conclusion</h2><p>That&rsquo;s it! Let&rsquo;s recap:</p><ul><li>You can create a cordova app.</li><li>You can place your own game files in there, changing what&rsquo;s needed to make full use of cordova</li><li>You can setup all configuration and paths to make exporting work</li><li>You can emulate, test run, debug, and build to any target</li><li>You can create keystores and bundles to professionally publish the game</li><li>You can add extra common functionality, such as camera or AdMob</li></ul><p>Hopefully this was clear and informative. As you can see, I&rsquo;m amazing at hitting every roadblock imaginable, so learning this and setting it up took me quite some time. I tried to distill that into a to-the-point tutorial.</p><p>I really hope we find a better system for Android/Java/SDK stuff some day. As well as a better system for Ads or Play Store integration. But for now, in the current day, this is the amount of work you need to go through to get a simple jumping ball on a phone screen and a banner ad below it.</p><p>Until the next time,</p><p>Pandaqi</p></div></article><div><nav class=pagination><ul><li><a href=/blog/tutorials/placing-grids-within-spaces/ class="masked-link big-mask mask-7" style=--rotation:0deg>&lt;&lt; Previous Page</a></li><li>Continue reading</li><li><a href=/blog/tutorials/deploy-phaser-game-as-executables/ class="masked-link big-mask mask-5" style=--rotation:-1deg>>> Next Page</a></li></ul></nav></div></main><footer id=site-footer><div class="padding center-block"><h3>More Pandaqi</h3><p>You could <a href=https://pandaqi.com>visit the game studio</a>.
Or my <a href=https://pandaqi.com/tutorials/>free tutorial website</a>.
Or my <a href=https://rodepanda.com/>portfolio</a> with easy access to absolutely everything I ever made.</p><h3>Latest</h3><nav class=latest><ul><li><a href=/blog/boardgames/the-outnumbered-series/nine-lives/>Nine Lives
(üêà)</a></li><li><a href=/blog/boardgames/the-outnumbered-series/nine-lives-math-meows/>Nine Lives: Math Meows
(üêà)</a></li><li><a href=/blog/reviews-and-thoughts/game-dev-how-to-prioritize/>Game Dev: How to prioritize?
(üí¨)</a></li><li><a href=/blog/reviews-and-thoughts/game-dev-what-are-you-telling-players/>Game Dev: What are you telling players?
(üí¨)</a></li><li><a href=/blog/reviews-and-thoughts/the-summer-of-game-jams/>The Summer of Game Jams (2024)
(üí¨)</a></li><li><a href=/blog/boardgames/swiftsmash-saga/cookie-smasher/>Cookie Smasher
(üç™)</a></li><li><a href=/blog/reviews-and-thoughts/my-thoughts-on-defold-engine/>My Thoughts on Defold Engine</a></li><li><a href=/blog/reviews-and-thoughts/my-thoughts-on-phaser-3-engine/>My Thoughts on Phaser 3</a></li><li><a href=/blog/reviews-and-thoughts/my-thoughts-on-godot-engine/>My Thoughts on the Godot game engine</a></li><li><a href=/blog/news-and-updates/no-more-play-store/>No More Play Store
(üì±)</a></li></ul></nav><h3>Sections</h3><nav><ul><li><a href=/blog/boardgames/>Boardgames
(üé≤)</a></li><li><a href=/blog/news-and-updates/>News & Updates
(üì¢)</a></li><li><a href=/blog/reviews-and-thoughts/>Reviews & Thoughts
(üí≠)</a></li><li><a href=/blog/tutorials/>Tutorials
(üë©‚Äçüéì)</a></li><li><a href=/blog/videogames/>Videogames
(üéÆ)</a></li></ul></nav><h3>Credits</h3><p>Theme by me (<a href=https://pandaqi.com>Pandaqi</a> üêº) &#183;
with ‚ù§Ô∏è &#183;
using <a href=https://gohugo.io>Hugo</a> &#183;
&copy; 2018&ndash;2024 Pandaqi Blog</p></div></footer><link rel=stylesheet type=text/css href=/blog/css/style.css><script src=/blog/js/main.bundle.min.js async defer></script></body></html>