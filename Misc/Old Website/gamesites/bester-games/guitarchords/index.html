<!DOCTYPE html>
<html>
<head>
	<title>Guitar Chords Heaven</title>
	<style type="text/css">
	@font-face {
		/*font-family:'Trebuchet MS';
		src:url('Trebuchet MS.ttf');*/
		font-family:'Open Sans';
		src:url('OpenSans-Light.ttf');
	}
	@font-face {

		font-family: 'Molot';
		src:url('Molot.otf');
	}

	html, body {
		width:100%;
		height:100%;
		margin:0;
		padding:0;
		/*background-color:#fcfcfc;*/
		overflow:hidden;
		color:rgb(66,33,33);
		font-family:Calibri;
	}

	p {
		max-width: 705px;
	}

	.bodyStyle1 {
		background-image: linear-gradient(rgba(250, 250, 250, 0.9),  rgba(255,222,173,0.9)),  url(landscapeGuitar1.jpg);
		background-size:100%;
	}
	.bodyStyle2 {
		background-image: linear-gradient(rgba(250, 250, 250, 0.9),  rgba(255,222,173,0.9)),  url(landscapeGuitar2.jpg);
		background-size:100%;
	}
	.bodyStyle3 {
		background-image: linear-gradient(rgba(250, 250, 250, 0.9),  rgba(255,222,173,0.9)),  url(landscapeGuitar3.jpg);
		background-size:100%;
	}
	.bodyStyle4 {
		background-image: linear-gradient(rgba(250, 250, 250, 0.92),  rgba(255,222,173,0.92)),  url(landscapeGuitar4.jpg);
		background-size:100%;
	}
	.bodyStyle5 {
		background-image: linear-gradient(rgba(250, 250, 250, 0.91),  rgba(255,222,173,0.91)),  url(landscapeGuitar5.jpg);
		background-size:100%;
	}
	.bodyStyle6 {
		background-image: linear-gradient(rgba(250, 250, 250, 0.92),  rgba(255,222,173,0.92)),  url(landscapeGuitar6.jpg);
		background-size:100%;
	}

	.chordDiv {
		width:156px;
		height:180px;
		border:2px solid #CCC;
		margin-bottom:10px;
	}

	div:not(.diagramSearch) > .chordDivContainer > .chordDiv:hover{
		box-shadow:0px 0px 10px #333;
		transform: scale(2.5);
		cursor:pointer;
	}
	.diagramSearch {
		margin: auto;
		width: 100px;
		transform: scale(3);
	}
	.toLeft .chordDiv:hover {
		transform:scale(2);
		transform-origin:0% 0%;
	}
	.toRight .chordDiv:hover {
		transform:scale(2);
		transform-origin:100% 0%;
	}
	.theSVG {
		background-color:#fcfcfc;
	}

	.chordDivContainer {
		width:160px;
		text-align:center;
		display:table-cell;
		padding:20px;
	}

	#scrollChordTable {
		min-height:100px;
		overflow:auto;
		padding:120px;
		text-align:center;
		box-sizing:border-box;
	}

	#chordTable {
		display:table;
	}

	.theSVG {
		width:100%;
		height:100%;
		font-family:Rockwell;
		font-size:12px;
	}

	#mainNav {
		width:25%;
		min-width:450px;
		display:table-cell;
	}
	#subNav {
		width:10%;
		display:none;
		min-width:190px;
		vertical-align: top;
	}

	.navTable {
		font-family:Molot;
		font-size:24px;
		box-sizing:border-box;
	}
	.navTable tr td {
		border-bottom:1px solid gray;
	}
	.navTable tr td:hover {
		background-color:#333;
		cursor:pointer;
		color:white;
	}

	#subNav2 {
		width:10%;
		display:none;
		min-width:190px;
		vertical-align: top;
	}
	#subNav2 tr td {
		font-size:16px;
	}

	#mainContent {
		display:table-cell;
		vertical-align: top;
	}

	#main {
		width:100%;
		height:100%;
		display:table;
	}
	.selected {
		background-color: rgba(255,60,20,0.3);
	    color: crimson;
	}
	.selected2 {
		background-color:rgba(255,200,150,0.4);		
	}
	.notRegularChord {
		display:none;
	}

	h1 {
		font-size:2.5em;
		text-shadow: 0 1px white, 0 2px #777;
	    border-left: 15px solid rgba(50,150,255,0.2);
		box-shadow: -10px 0 10px -4px rgba(50,150,255,0.2);
	    padding-left: 20px;
	}

	article {
	    font-size: 18px;
	    font-weight: 100;
	    line-height: 1.8;
	    height:100%;
	    overflow:auto;
	    box-sizing:border-box;
	    padding-left:30px;
	    padding-right:30px;
	    /*max-width:900px;*/
		/*font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;*/
    	/*font-family:"Trebuchet MS", Arial, Verdana, sans-serif;*/
    	font-family:'Open Sans';
	}

	hr {
		 border: 0;
	    border-bottom: 1px dashed #ccc;
	    background: #999;
	}

	::selection {
		color: red;
	    background-color: rgba(50,250,50,0.1);
	}

	#articleTable {
		width:100%;
	}
	#articleTable tr td {
		border:1px solid #CCC;
	}

	.toRight {
		float:right;
		margin-left:20px;
	}
	.toLeft {
		float:left;
		margin-right:20px;
	}

	input {
		width: 70%;
		font-size:24px;
		padding:15px;
		font-family:Molot;
		float:left;
	}

	button {
		font-size:24px;
		float:right;
		background-color:#996633;
		padding:15px;
		color:white;
		font-family:Molot;
		border:2px solid #CCC;
		transition: background-color 0.35s, color 0.35s;
	}

	button:hover {
		background-color:#FFBB99;
		color:IndianRed;
		cursor:pointer;
	}
	</style>
	<script src="jquery-2.1.4.min.js"></script>
	<script src="chordDictionary.js"></script>
	<script>
	var WIDTH = 27;
	var HEIGHT = 180;
	var tempIDs = -1;
	var currentChords = 0;

	var noteBuilding = [[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]];
	var keyBuilding = [0,0,0,0,0,0,0,0,0,0,0,0,0];

	var listOfVar = ["Major","Minor","Suspended 2nd","Suspended 4th","Major 7th","Minor 7th","Major 9th","Minor 9th","Major 6th","Minor 6th","Dominant 7th","Dominant 9th","Dominant 11th","Dominant 13th","Added 9th"];

	var links = [[],["Overview","Music Theory","Major/Minor Chords","Dominant Chords","Slash/Power Chords","Miscellaneous"],["Overview","Major Scales","Minor Scales","Scale Modes","-","-"],["Chord Name <span style='font-size:10px;'>(guitar)</span>","Chord Diagram <span style='font-size:10px;'>(guitar)</span>","-","-","Chord Name <span style='font-size:10px;'>(piano)</span>","Chord Diagram <span style='font-size:10px;'>(piano)</span>"],[]];

	function searchChord(type) {
		var str = $("#searchField").val(); 
		var searchValue = str.replace(/[^\s]+/g, function(word) {
		  return word.replace(/^./, function(first) {
		    return first.toUpperCase();
		  });
		});
		var resultCount = 'Sorry, we could not find anything.';
		$("#chordTable").html(' ');
		currentChords = 0;
		$("#actualContent").css("height",'initial');
		for(var key in chords) {
			if(key == searchValue || chords[key][0] == searchValue) {
				if(type == 0) {
					loadChord(key,-1);					
				} else if(type == 1) {
					loadPianoChord(key,-1);
				}
				resultCount = 'Yes, we found it!';
			}
		}
		$("#feedbackSpan").html("Searched for <strong>" + searchValue + "</strong>. " + resultCount);
	}
	function addNote(e) {
		var div = $("#chordRow0 svg");
		var re = findRelativePos(div[0]);
		var mouseX = (e.pageX - re[0])/3+18;
		var mouseY = (e.pageY - re[1])/3+38;

		var gridSize = 27;
		mouseX = gridSize * Math.round((mouseX-10)/gridSize)+10;
		gridSize = 40;
		mouseY = gridSize * Math.round((mouseY-38)/gridSize)+38;
		noteBuilding[Math.round((mouseY-38)/40)][Math.round((mouseX-10)/27)] = 1;
		var theCircle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
		theCircle.setAttribute("cx",mouseX);
		theCircle.setAttribute("cy",mouseY);
		theCircle.setAttribute("fill","#996633");
		theCircle.setAttribute("r","10");
		theCircle.classList.add('extraOne');
		document.getElementsByClassName('theSVG')[0].appendChild(theCircle);
	}

	function findRelativePos(obj) {
		var curleft = curtop = 0;
		if (obj.offsetParent) {
			do {
			curleft += obj.offsetLeft;
			curtop += obj.offsetTop;
			} while (obj = obj.offsetParent);
		}
		return [curleft,curtop];
	}

	function changedFret() {
		var e = $("#searchField").val();
		if(e == '' || e == 0) {
			$("#chordDiagramTopBox").css('display','initial');
			$("#chordDiagramFretLine").css('display','none');
			$("#chordDiagramFretNumber").node.textContent = '';
		} else {
			$("#chordDiagramTopBox").css('display','none');
			$("#chordDiagramFretLine").css('display','initial');
			$("#chordDiagramFretNumber").node.textContent = e;
		}
	}

	function loadChordProgression(ID) {
		var scales = {
			"Major":[[0,2,4,5,7,9,11],["Major","Minor","Minor","Major","Major","Minor","Diminished"],["Major 7th","Minor 7th","Minor 7th","Major 7th","Dominant 7th","Minor 7th","Half-Diminished"]],
			"Minor":[[0,1,3,5,7,8,10],["Minor","Diminished","Major","Minor","Minor","Major","Major"]],
			"Harmonic Minor":[[0,1,3,5,7,8,11],["Minor","Diminished","Major","Minor","Minor","Major","Major"],["Minor Major 7th","Minor 7th b5","Major 7th #5","Minor 7th","Dominant 7th","Major 7th","Diminished 7th"]],
			"Melodic Minor":[[0,2,3,5,7,9,11],["Minor","Diminished","Major","Minor","Minor","Major","Major"],["Minor","Minor","Augmented","Major","Major","Diminished","Diminished"],["Minor Major 7th","Minor 7th","Major 7th #5","Dominant 7th","Dominant 7th","Minor 7th b5","Minor 7th b5"],["Minor Major 7th","Dominant 7th susb9","Major 7th #5","Dominant 7th #11","Dominant 7th b13","Minor 7th b5","Dominant 7th Altered"]]
		}
		var musicRel = {
			"C":0,
			"C#":1,
			"D":2,
			"D#":3,
			"E":4,
			"F":5,
			"F#":6,
			"G":7,
			"G#":8,
			"A":9,
			"A#":10,
			"B":11
		};
		var chosenKey;
		var count = 0;
		for(var key in scales) {
			count++;
			if(Math.random() < 1/count) {
				chosenKey = key;
			}
		}
		var refPos = musicRel[ID];
		var chosenVar = Math.round(Math.random()*(scales[chosenKey].length-2)-0.49)+1;
		var length = Math.round(Math.random()*3.49)+2;
		var chords = '';
		for(var a=0;a<length;a++) {
			var rand = 0;
			if(a != 0) {
				rand = Math.round(Math.random()*5)+1;
				chords += " -- ";
			}
			var theNote = (refPos+scales[chosenKey][0][rand])%12;
			var theName = '';
			for(var key in musicRel) {
				if(musicRel[key] == theNote) {
					theName = key;
				}
			}
			var appendEnd = scales[chosenKey][chosenVar][rand];
			if(Math.random() < 0.2) {
				appendEnd = "Suspended 2nd";
			} else if(Math.random() < 0.2) {
				appendEnd = "Suspended 4th";
			} else if(Math.random() < 0.2) {
				appendEnd = "Added 9th";
			}
			var theChord = theName + " " + appendEnd;
			chords += theChord;
		}
		$("#actualContent").append("<strong>Scale:</strong> " + chosenKey + "<br/><br/><strong>Chords:</strong> " + chords);
	}

	function searchChordDiagram() {
		var fret = $("#searchField").val();
		if(fret == '' || fret == null || fret == undefined) {
			fret = 0;
		}
		//var rows
		var succeeded = false;
		for(var key in chords) {
			for(var a=1;a<chords[key].length;a++) {
				if(chords[key][a][1] == fret) {
					var keepCount = 0;
					for(var i=2;i<6;i++) {
						var myTotal = 0;
						for(var b=0;b<6;b++) {
							myTotal += noteBuilding[i-2][b];
						}
						if(myTotal == 0 && chords[key][a][i].length == 0) {
							keepCount++;
							continue;
						}
						if(chords[key][a][i].length != 0) {
							var areWeGood = 0;
							for(var b=0;b<6;b++) {
								if((chords[key][a][i][b] != 0 && noteBuilding[i-2][b] != 0) || (chords[key][a][i][b] == noteBuilding[i-2][b])) {
									areWeGood++;
								} else {
									break;
								}
							}
							if(areWeGood == 6) {
								keepCount++;
							} 
						}
					}
					if(keepCount == 4) {
						$("#feedbackSpan").html('We like to call this chord a <strong>' + key + '</strong> (' + chords[key][0] + ').');
						succeeded = true;
					}
				}
			}
		}
		if(!succeeded) {
			$("#feedbackSpan").html("Sorry, we don't do alien chords.");
		}
	}

	function searchPianoChordDiagram() {
		var getList = [];
		var nameList = [];
		var ugh = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
		for(var a=0;a<12;a++) {
			for(var b=0;b<listOfVar.length;b++) {
				var makeName = ugh[a] + " " + listOfVar[b];
				nameList[a*12+b] = makeName;
				var expChord = makeName.split(" ");
				getList[a*12+b] = makeChordFromName([0,0,0,0,0,0,0,0,0,0,0,0],a,expChord);
			}
		}
		var succeeded = false;
		for(var a=0;a<getList.length;a++) {
			var counter = 0;
			for(var b=0;b<keyBuilding.length;b++) {
				if(keyBuilding[b] == getList[a][b]) {
					counter++;
				}
			}
			if(counter == 12) {
				$("#feedbackSpan").html('We like to call this chord a <strong>' + nameList[a] + '</strong>');
				succeeded = true;
				break;
			}
		}
		if(!succeeded) {
			$("#feedbackSpan").html("Sorry, we don't do chords made for squirrels.");
		}
	}

	function init() {
		var COUNTER = 0;
		for(var key in chords) {
			for(var i=0;i<chords[key].length;i++) {
				COUNTER++;
			}
		}
		console.log(COUNTER);

		var currentAction = -1;
		$("#scrollChordTable").css('max-height',(window.innerHeight-300)+'px');

		$("#mainNav table tr td").click(function() {
			var randNum = Math.round(Math.random()*5.98-0.49)+1;
			$("body").attr('class','bodyStyle'+randNum);
			var ID = parseInt($(this).attr('id'));
			if(currentAction != ID) {
				currentChords = 0;
				$("#chordTable").html('');
				$("#mainNav table tr td").removeClass("selected");
				currentAction = ID;
				$("#subNav table tr td").removeClass("selected");
				$("#subNav").css('display','none');
				$("#subNav2").css('display','none');
				switch(ID) {
					case 0:
						$("#actualContent").css('padding-bottom','0px');
						$("#actualContent").css('height','initial');
						$('#actualContent').html('<h1>Please pick a base key for your chord progression...</h1>');
						$("#subNav").css('display','table-cell');
					break;
					case 1:
					case 2:
					case 3:
						$("#actualContent").html(ARTICLES[ID][0]);
						var tempCnt = 0;
						$('#subNav2 table tr td').each(function () {
							if(links[ID][tempCnt] == "-") {
								$(this).css('visibility','hidden');
							} else {
								$(this).css('visibility','visible')
							}
						    $(this).html(links[ID][tempCnt]);
						    tempCnt++;
						});
						$('#subNav2 table tr td').removeClass('selected');
						$("#sub0").addClass('selected');
						$('#subNav2').css('display','table-cell');
						$("#actualContent").css('height','100%');
						$("#actualContent").css('padding-bottom','50px');
					break;
					case 4:
					case 5:
						$("#actualContent").css('padding-bottom','0px');
						$("#actualContent").css('height','initial');
						$('#actualContent').html('<h1>Please pick the key of which you want to see all chords...</h1>');
						$("#subNav").css('display','table-cell');
					break;
				}
				$(this).addClass("selected");
			}
		});

		$("#subNav2 table tr td").click(function() {
			$("#actualContent").scrollTop(0);
			$("#subNav2 table tr td").removeClass("selected");
			$("#chordTable").html(' ');
			var ID = $(this).attr('id').substr(3);
			$("#actualContent").html(ARTICLES[currentAction][ID]);
			var counter = -1;
			$("#actualContent").find(".inlineChord").each(function() {
				counter++;
				if($(this).hasClass('piano')) {
					loadPianoChord($(this).attr('title'),counter,true);
				} else {
					loadChord($(this).attr('title'),counter);					
				}
			});
			$(this).addClass("selected");
			if(ID == 1){
				$(document).keypress(function(event) {
				      var e = event.which;
				      if(e == 115) {
				      	$(".extraOne").remove();
				      	noteBuilding = [[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]];
				      }
				});
			}
			if(ID == 5) {
				keyBuilding = [0,0,0,0,0,0,0,0,0,0,0,0];
			}
		});


		$("#subNav table tr td").click(function() {
			$("#subNav table tr td").removeClass("selected");
			var ID = $(this).html();
			if(currentAction == 0) {
				//Make up a nice chord progression in this key
				$("#actualContent").html("<h1>Here's a nice chord progression in " + ID + "</h1>");
				loadChordProgression(ID);
			} else if(currentAction == 5) {
				//Get all chords in this key
				var allOptions = [];
				for(var key in chords) {
					if(ID.length == 2) {
						if(ID == key.substring(0,2)) {
							allOptions.push(key);
						}
					} else if(ID.length == 1) {
						if(ID == key.substring(0,1) && ID+"#" != key.substring(0,2)) {
							allOptions.push(key);
						}
					}
				}
				$("#chordTable").html(' ');
				currentChords = 0;
				for(var i=0;i<allOptions.length;i++) {
					loadChord(allOptions[i],-1);
				}
				$("#actualContent").html("<h1>All chords and their variations in " + ID + "</h1><p>Hover over any chord to see it enlarged. Click on a chord to see all variations or other ways to play it (if there are any).</p>");
			} else if(currentAction == 4) {
				$("#chordTable").html(' ');
				currentChords = 0;
				for(var i=0;i<listOfVar.length;i++) {
					loadPianoChord(ID+" "+listOfVar[i],-1);
				}
				$("#actualContent").html("<h1>All chords and their variations in " + ID + "</h1><p>Hover over any chord to see it enlarged.<br/>Every chord can be played with the notes in a different order than the one given below, as long as you play the same notes.</p>");
			}
			$(this).addClass("selected");
		});

		$("#mainContent").on("click", ".chordDivContainer", function(){
			if($(this).find(".notRegularChord").css('display') == 'none') {
				$(this).addClass("selected2");
				$(this).find(".notRegularChord").css('display','block');
			} else {
				$(this).removeClass("selected2");
				$(this).find(".notRegularChord").css('display','none');
			}
		});
	}
	function turnOnOff(e) {
		var ID = e.target.id;
		if(keyBuilding[ID] == 0) {
			e.target.setAttribute("fill","DarkTurquoise");
			e.target.setAttribute("stroke","DarkSlateGray");
			keyBuilding[ID] = 1;
		} else if(keyBuilding[ID] == 1) {
			if(e.target.getAttribute('title') == 'black') {
				e.target.setAttribute("fill","#000");	
				e.target.setAttribute("stroke","#000");
			} else {
				e.target.setAttribute("fill","white");	
				e.target.setAttribute("stroke","#333");
			}
			keyBuilding[ID] = 0;
		}
	}

	function makeChordFromName(chordBuild,ref,expChord) {
		var majMin = 0;
		var startPos = 2;
		chordBuild[ref] = 1;
		if(expChord.length == 1 || expChord[1] == "Major") {
			chordBuild[(ref+4)%12] = 1;
			majMin = 1;		
		} else if(expChord[1] == "Minor") {
			chordBuild[(ref+3)%12] = 1;
			majMin = 0;
		} else if(expChord[1] == "Dominant" || expChord[1] == "Added") {
			chordBuild[(ref+4)%12] = 1;
			majMin = 1;
			startPos = 1;
		} else {
			startPos = 1;
		}
		chordBuild[(ref+7)%12] = 1;
		var initSus = 0;
		var initDom = 0;
		var initAdd = 0;
		for(var i=startPos;i<expChord.length;i++) {
			if(expChord[i] == "6th") {
				chordBuild[(ref+8+majMin)%12] = 1;
			} else if(expChord[i] == "7th") {
				if(initDom == 1) {
					chordBuild[(ref+10)%12] = 1;
				} else {
					chordBuild[(ref+majMin+10)%12] = 1;					
				}
			} else if(expChord[i] == "9th") {
				if(initDom == 1) {
					chordBuild[(ref+10)%12] = 1;
				} else if (initAdd != 1) {
					chordBuild[(ref+majMin+10)%12] = 1;
				}
				chordBuild[(ref+majMin+13)%12] = 1;
			} else if(expChord[i] == "Suspended") {
				chordBuild[(ref+majMin+3)%12] = 0;
				initSus = 1;
			} else if(expChord[i] == "2nd") {
				if(initSus == 1) {
					chordBuild[(ref+2)%12] = 1;
				}
			} else if(expChord[i] == "4th") {
				if(initSus == 1) {
					chordBuild[(ref+5)%12] = 1;
				}
			} else if(expChord[i] == "Added") {
				initAdd = 1;
			} else if(expChord[i] == "Dominant") {
				initDom = 1;
			}
		}
		return chordBuild;
	}

	//Parameters: chord name, number of inserting div (-1 if not inserting but in table)
	function loadPianoChord(whichOne, insert, clickable) {
		var saveIt = tempIDs;
		var tW = 5;
		var isItSpecial = false;
		var howMany = 4;
		var whereAreWe = insert;
		if(insert == -1) {
			whereAreWe = Math.floor(currentChords/tW);
			if(currentChords%tW == 0) {
				$("#chordTable").append("<div style='display:table-row;' id='chordRow" + whereAreWe + "'></div>")
			}
		}
		var fontSize = 24;
		if(whichOne.length > 16) {
			fontSize = 14;
		} else if(whichOne.length > 13) {
			fontSize = 18;
		}
		var shortName = ' - ';
		if(chords[whichOne] != undefined) {
			shortName = chords[whichOne][0];
		}
		$("#chordRow"+whereAreWe).append('<div class="chordDivContainer" id="container' + tempIDs+ '"><span style="font-size:' + fontSize + 'px;font-family:Calibri;color:#333;">' + whichOne + '</span><br/><span style="font-size:12px;font-family:Calibri;color:#999;">' + shortName + '</span><br/><div class="chordDiv" style="height:80px;width:149px;" id="chordDiv' + tempIDs + '"></div></div>');
		currentChords++;

		var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
		svg.classList.add('theSVG');
		svg.setAttribute('background-color','white');
		//Background
		var musicRel = {
			"C":0,
			"C#":1,
			"D":2,
			"D#":3,
			"E":4,
			"F":5,
			"F#":6,
			"G":7,
			"G#":8,
			"A":9,
			"A#":10,
			"B":11
		};
		var chordBuild = [0,0,0,0,0,0,0,0,0,0,0,0,0];
		var expChord = whichOne.split(" ");
		var ref = musicRel[expChord[0]];
		chordBuild = makeChordFromName(chordBuild,ref,expChord);
		//var chordBuild = [1,0,0,1,1,0,0,1,0,0,0,0,0];
		var amount = 7;
		var whiteSpots = [0,2,4,5,7,9,11];
		var blackSpots = [1,3,6,8,10];
		var blackPos = [15,37,79,100,121];
		for(var i=0;i<amount;i++) {
			var absoluteIndex = whiteSpots[i];
			var theLine = document.createElementNS("http://www.w3.org/2000/svg", "path");
			var xPos = i*(150/(amount-1)-4)+1;
			var xPos2 = (i+1)*(150/(amount-1)-4)+1; 
			var theD = "M" + xPos + ",0 L" + xPos + ",80 L" + xPos2 + ",80 L" + xPos2 + ",0 Z";
			theLine.setAttribute("d",theD);
			theLine.setAttribute("stroke-width","1px");
			theLine.setAttribute("id",whiteSpots[i]);
			if(chordBuild[absoluteIndex] == 0) {
				theLine.setAttribute("fill","white");	
				theLine.setAttribute("stroke","#333");			
			} else {
				theLine.setAttribute("fill","DarkTurquoise");
				theLine.setAttribute("stroke","DarkSlateGray");
			}
			if(clickable) {
				theLine.addEventListener('click',turnOnOff);
			}
			svg.appendChild(theLine);
			if(chordBuild[absoluteIndex] != 0) {
				var someText = document.createElementNS("http://www.w3.org/2000/svg", "text");
				someText.setAttribute("x",xPos+7);
				someText.setAttribute("y",78);
				someText.setAttribute("font-size",'10px');
				someText.setAttribute("fill","#336699");
				for(var key in musicRel) {
					if(musicRel[key] == absoluteIndex) {
						someText.textContent = key;
					}
				}
				svg.appendChild(someText);
			}
		}
		for(var j=0;j<blackSpots.length;j++) {
			var theLine = document.createElementNS("http://www.w3.org/2000/svg", "path");
			var xPos = blackPos[j];
			var xPos2 = blackPos[j]+12;
			var theD = "M" + xPos + ",0 L" + xPos + ",50 L" + xPos2 + ",50 L" + xPos2 + ",0 Z";
			theLine.setAttribute("d",theD);
			theLine.setAttribute("stroke-width","1px");
			theLine.setAttribute('id',blackSpots[j]);
			theLine.setAttribute("title","black");
			if(chordBuild[blackSpots[j]] == 0) {
				theLine.setAttribute("stroke","#000");
				theLine.setAttribute("fill","#000");
			} else {
				theLine.setAttribute("fill","DarkTurquoise");
				theLine.setAttribute("stroke","DarkSlateGray");
			}
			if(clickable) {
				theLine.addEventListener('click',turnOnOff);
			}
			svg.appendChild(theLine);
			if(chordBuild[blackSpots[j]] != 0) {
				var someText = document.createElementNS("http://www.w3.org/2000/svg", "text");
				someText.setAttribute("x",xPos+2);
				someText.setAttribute("y",48);
				someText.setAttribute("font-size",'6px');
				someText.setAttribute("fill","#336699");
				for(var key in musicRel) {
					if(musicRel[key] == blackSpots[j]) {
						someText.textContent = key;
					}
				}
				svg.appendChild(someText);
			}
		}
		$("#actualContent").css('height','initial');
		$("#chordDiv"+tempIDs).append(svg);
		tempIDs++;
	}
	//Parameters: chord name, number of inserting div (-1 if not inserting but in table)
	function loadChord(whichOne,insert) {
		var saveIt = tempIDs;
		var tW = 5;
		var isItSpecial = false;
		var howMany = 4;
		var whereAreWe = insert;
		if(insert == -1) {
			whereAreWe = Math.floor(currentChords/tW);
			if(currentChords%tW == 0) {
				$("#chordTable").append("<div style='display:table-row;' id='chordRow" + whereAreWe + "'></div>")
			}
		}
		var fontSize = 24;
		if(whichOne.length > 16) {
			fontSize = 14;
		} else if(whichOne.length > 13) {
			fontSize = 18;
		}
		var variationExtra = '';
		if(chords[whichOne].length > 2) {
		variationExtra = '<span style="font-size:10px;font-family:Calibri;color:#999;float:right;margin-left:-50px;">(' + (chords[whichOne].length-1) + ' var.)</span>';
		}
		$("#chordRow"+whereAreWe).append('<div class="chordDivContainer" id="container' + tempIDs+ '"><span style="font-size:' + fontSize + 'px;font-family:Calibri;color:#333;">' + whichOne + '</span><br/><span style="font-size:12px;font-family:Calibri;color:#999;">' + chords[whichOne][0] + '</span>' + variationExtra + '<br/></div>');
		currentChords++;
		for(var a=1;a<chords[whichOne].length;a++) {
			isItSpecial = false;
			var chord = chords[whichOne][a];
			if(chord[1] < 0) {
				isItSpecial = true;
			}
			tempIDs++;
			howMany = 4;
			HEIGHT = 180;
			var extraStyling = '';
			if(isItSpecial) {
				howMany = 8;
				HEIGHT = 360;
				extraStyling = 'style="height:360px;"';
			}
			if(a != 1) {
				$("#container"+saveIt).append('<div class="chordDiv notRegularChord" ' + extraStyling + ' id="chordDiv' + tempIDs + '"></div>');		
			} else {
				$("#container"+saveIt).append('<div class="chordDiv" ' + extraStyling + ' id="chordDiv' + tempIDs + '"></div>');
			}
			var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
			svg.classList.add('theSVG');
			//Background
			var theBG = document.createElementNS("http://www.w3.org/2000/svg", "path");
			var theD = "M10,20 L" + (5*WIDTH+9) + ",20 L" + (5*WIDTH+9) + "," + HEIGHT + " L10," + HEIGHT + " Z";
			theBG.setAttribute("d",theD);
			theBG.setAttribute("fill","#F0E68C");
			svg.appendChild(theBG);
			//Horizontal lines
			for(var i=0;i<howMany;i++) {
				var theLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
				var yPos = (i+1)*(HEIGHT/howMany-3)+3*howMany;
				theLine.setAttribute("x1",0+10);
				theLine.setAttribute("x2",5*WIDTH+10);
				theLine.setAttribute("y1",yPos);
				theLine.setAttribute("y2",yPos);
				theLine.setAttribute("stroke-width","6px");
				theLine.setAttribute("stroke","#fff");
				svg.appendChild(theLine);
			}
			//Vertical stripes
			for(var i=0;i<6;i++) {
				var theLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
				var xPos = i*WIDTH+3+7;
				theLine.setAttribute("x1",xPos);
				theLine.setAttribute("x2",xPos);
				theLine.setAttribute("y1",20);
				theLine.setAttribute("y2",HEIGHT);
				theLine.setAttribute("stroke-width","4px");
				theLine.setAttribute("stroke","#A09247");
				svg.appendChild(theLine);
			}
			//Back bar, if necessary
			//Otherwise, just display which fret we're on and a red line to indicate we're at a special place
			if(chord[1] == 0 || whichOne == ' ') {
				var theBox = document.createElementNS("http://www.w3.org/2000/svg", "path");
				var d = "M0,0 L156,0 L156,20 L0,20 Z";
				theBox.setAttribute("d",d);
				theBox.setAttribute("stroke","#A09247");
				theBox.setAttribute("stroke-width","4px");
				theBox.setAttribute("fill","#F5E9BF");
				theBox.setAttribute("id",'chordDiagramTopBox');
				svg.appendChild(theBox);
			} 
			if(chord[1] > 0 || whichOne == ' ') {
				var theLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
				theLine.setAttribute("x1",8);
				theLine.setAttribute("x2",WIDTH*5+12); 
				theLine.setAttribute("y1",20);
				theLine.setAttribute("y2",20);
				theLine.setAttribute("stroke-width","4px");
				theLine.setAttribute("stroke","#992200");
				theLine.setAttribute("id",'chordDiagramFretLine');
				svg.appendChild(theLine);
				var someText = document.createElementNS("http://www.w3.org/2000/svg", "text");
				someText.setAttribute("x","1");
				someText.setAttribute("y","25");
				someText.setAttribute("fill","#992200");
				someText.setAttribute("id",'chordDiagramFretNumber');
				if(chord[1] > 9) {
					someText.setAttribute("font-size","6px");
				} else {
					someText.setAttribute("font-size","10px");					
				}
				if(whichOne != ' ') {
					someText.textContent = chord[1];					
				}
				svg.appendChild(someText);
			}
			//Displaying open/closed strings (O or X)
			if(chord[0].length > 0) {
				for(var i=0;i<6;i++) {
					if(chord[0][i] != -1) {
						var someText = document.createElementNS("http://www.w3.org/2000/svg", "text");
						var xPos = i*WIDTH+6;
						someText.setAttribute("x",xPos);
						someText.setAttribute("y",14);
						someText.setAttribute("fill","#336699");
						if(chord[0][i] == 0) {
							someText.textContent = 'O';
						} else {
							someText.textContent = 'X';					
						}
						svg.appendChild(someText);
					}
				}
			}
			//Actually displaying finger positions and which finger to use
			for(var i=2;i<chord.length;i++) {
				if(chord[i].length > 0) {
					for(var j=0;j<6;j++) {
						if(chord[i][j] != 0) {
							if(!isItSpecial) {
								for(var k=j;k<6;k++) {
									//There are multiple occurences of a single finger, this means a barred chord!
									if(chord[i][k] == chord[i][j]) {
										var barreLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
										var xPos1 = k*WIDTH+10;
										var xPos2 = j*WIDTH+10;
										var yPos = i*((HEIGHT-20)/howMany)-43;
										barreLine.setAttribute("x1",xPos1);
										barreLine.setAttribute("x2",xPos2);
										barreLine.setAttribute("y1",yPos);
										barreLine.setAttribute("y2",yPos);
										barreLine.setAttribute("stroke-width","8px");
										barreLine.setAttribute("stroke","#996633");
										svg.appendChild(barreLine);
									}
								}
							}
							var theCircle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
							var theText = document.createElementNS("http://www.w3.org/2000/svg", "text");
							if(isItSpecial) {
								if(chord[i][j] != 1) {
									theText.textContent = chord[i][j];									
								}
							} else {
								theText.textContent = chord[i][j];								
							}
							var xPos = j*WIDTH+10;
							var yPos = i*((HEIGHT-20)/howMany)-43;
							theCircle.setAttribute("cx",xPos);
							theText.setAttribute("x",xPos-3);
							theCircle.setAttribute("cy",yPos);
							theText.setAttribute("y",yPos+4);
							theCircle.setAttribute("fill","#996633");
							theText.setAttribute("fill","#663300");
							theCircle.setAttribute("r","10");
							svg.appendChild(theCircle);
							svg.appendChild(theText);
						}
					}
				}
			}
			$('#chordDiv' + tempIDs).append(svg);
			if(whichOne == ' ') {
				$("#chordDiagramFretLine").css('display','none');
				$("#chordDiagramFretNumber").textContent = ' ';
			}
		}
	}
	</script>
</head>
<body onload="init();" class="bodyStyle1">
	<div id="main">
		<div id="mainNav">
			<table width="100%" height="100%" class="navTable" cellspacing="0" cellpadding="10">
				<tr><td id="0">Chord Progression Generator</td></tr>
				<tr><td id="1">Chord Theory</td></tr>
				<tr><td id="2">Guitar Scales</td></tr>
				<tr><td id="3">Search</td></tr>
				<tr><td id="4">All Piano Chords</td></tr>
				<tr><td id="5">All Guitar Chords</td></tr>
			</table>
		</div>
		<div id="subNav">
			<table width="100%" height="100%" class="navTable" cellspacing="0" cellpadding="10">
				<tr><td>A</td></tr>
				<tr><td>A#</td></tr>
				<tr><td>B</td></tr>
				<tr><td>C</td></tr>
				<tr><td>C#</td></tr>
				<tr><td>D</td></tr>
				<tr><td>D#</td></tr>
				<tr><td>E</td></tr>
				<tr><td>F</td></tr>
				<tr><td>F#</td></tr>
				<tr><td>G</td></tr>
				<tr><td>G#</td></tr>
			</table>
		</div>
		<div id="subNav2">
			<table width="100%" height="100%" class="navTable" cellspacing="0" cellpadding="10">
				<tr><td id="sub0">-</td></tr>
				<tr><td id="sub1">-</td></tr>
				<tr><td id="sub2">-</td></tr>
				<tr><td id="sub3">-</td></tr>
				<tr><td id="sub4">-</td></tr>
				<tr><td id="sub5">-</td></tr>
			</table>
		</div>
		<div id="mainContent">
			<article id="actualContent">
				<h1>Homepage</h1>
				<p>Pick anything you want to use or learn more about.<br/><br/>These things however have not yet been made:
					<ul>
						<li><b>Chord Progression Generator</b>: kinda works, has got to be finetuned though</li>
						<li><b>Guitar Scales</b>: last article has not been written
					</ul>
				</p>
			</article>
			<div id="scrollChordTable">
				<div id="chordTable">
					
				</div>
			</div>
		</div>
	</div>
</body>
</html>