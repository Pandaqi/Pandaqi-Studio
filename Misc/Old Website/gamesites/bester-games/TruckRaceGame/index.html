<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width,height=device-height" />
	<title>Bike Race Game!</title>
	<style type="text/css">
	body {
		margin:0;
		padding:0;
		width:100%;
		height:100%;
		background-color:black;
		overflow:hidden;
		-webkit-user-select: none;
		user-select: none;
		font-family: Rockwell;
	}
	#menuOverlay {
		position:fixed;
		top:0;
		width:100%;
		height:100px;
		left:0;
		display:none;
	}
	.menuButton {
		display:inline-block;
		float:right;
		width:100px;
		text-align:center;
		padding-top:30px;
		padding-bottom:30px;
	}
	.menuButton:hover {
		background-color:#5555AA;
		color:white;
		cursor:pointer;
	}
	.selected {
		background-color:#AA5555;
		color:white;
	}
	#mainMenu {
		position:absolute;
		top:0;
		left:0;
		right:0;
		bottom:0;
		height:600px;
		width:800px;
		margin:auto;
		display: none;
	}
	#mainMenu div {
		width:100%;
		box-sizing:border-box;
		padding:100px;
		font-size:100px;
		text-align: center;
	}
	#mainMenu div:hover {
		background-color:#55AA55;
		color:white;
		cursor:pointer;
	}
	</style>
	<!-- <script src="phaser-no-physics.min.js"></script> -->
	<script src="phaser.2.2.2.box2d.min.js"></script>
	<script src="Boot.js"></script>
	<script src="Load.js"></script>
	<script src="MainMenu.js"></script>
	<script src="MainGame.js"></script>
	<script src="Editor.js"></script>
</head>
<body>
<div id="menuOverlay">
	<div class="menuButton selected" id="0" onClick="menuFunc('normal');">Normal</div>
	<div class="menuButton" id="1" onClick="menuFunc('start');">Start Pos</div>
	<div class="menuButton" id="2" onClick="menuFunc('erase');">Eraser</div>
	<div class="menuButton" id="3" onClick="menuFunc('cows');">Cows</div>
	<div class="menuButton" id="theSaver" onClick="menuFunc('save');">Save Result!</div>
	<div class="menuButton" style="border-right:1px solid gray; border-left:1px solid gray;color:transparent;">SEPERATOR</div>
	<span id="extraOptions">
	<div class="menuButton selected" id="style0" onClick="styleFunc('free');">Freeform</div>
	<div class="menuButton" id="style1" onClick="styleFunc('line');">Line</div>
	<div class="menuButton" id="style2" onClick="styleFunc('circle');">Circle</div>
	</span>
</div>
<div id="mainMenu">
	<div onClick="buttonFunc('level');">Start Level</div>
	<div onClick="buttonFunc('editor')">Level Editor</div>
</div>
<script type="text/javascript">
var game = null;

window.onload = function() {
	game = new Phaser.Game('100%','100%',Phaser.AUTO,'O');
	game.state.add('Boot',Scene.Boot);
	game.state.add('Load', Scene.Load);
	game.state.add('MainMenu', Scene.MainMenu);
	game.state.add('Main', Scene.Main);
	game.state.add('Editor', Scene.Editor);
	game.state.start('Boot');
}

function buttonFunc(a) {
	document.getElementById('mainMenu').style.display = 'none';
	switch(a) {
		case 'level':
			game.state.start('Main');
		break;
		case 'editor':
			game.state.start('Editor');
		break;
	}
}

function styleFunc(a) {
	document.getElementById("style"+drawStyle).classList.remove('selected');
	switch(a) {
		case 'free':
			drawStyle = 0;
		break;
		case 'line':
			drawStyle = 1;
		break;
		case 'circle':
			drawStyle = 2;
		break;
	}
	document.getElementById("style"+drawStyle).classList.add('selected');		
}

function menuFunc(a) {
	document.getElementById(drawType).classList.remove('selected');
	document.getElementById('extraOptions').style.display = 'none';
	switch(a) {
		case 'normal':
			document.getElementById('extraOptions').style.display = 'block';
			drawType = 0;
		break;
		case 'start':
			drawType = 1;
		break;
		case 'save':
			var obj = {startPos:saveStart, normal:curE, dim:originalDimensions, cows:saveCows};
			localStorage.setItem("saveGame",JSON.stringify(obj));
			document.getElementById('theSaver').style.color = 'green';
		break;
		case 'cows':
			drawType = 3;
		break;
		case 'erase':
			drawType = 2;
		break;
	}
	if(a != 'save') {
		document.getElementById(drawType).classList.add('selected');		
	}
}

function dist2() {
	var a = [groundVertices[0],groundVertices[1]];
	var b = [groundVertices[groundVertices.length-2],groundVertices[groundVertices.length-1]];
	return Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2));
}

function checkCircle() {
	var isItCircle = true;
	if(dist2() < 200) {
		for(var i=0;i<groundVertices.length;i+=4) {
			var angle = Math.atan2(groundVertices[i+3]-groundVertices[i+1],groundVertices[i+2]-groundVertices[i]);
			if(angle > 0.75*Math.PI && Math.abs(angle-Math.PI) > 0.75*Math.PI) {
				isItCircle = false;
				break;
			}
		}
	} else {
		isItCircle = false;
	}
	return isItCircle;
}
</script>
</body>
</html>